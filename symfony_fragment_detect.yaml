id: Symfony_fragment_RCE

info:
    name: Finding /_fragment path
    author: Palanichamy_perumal
    severity: Critical
    description: searches for the Symfony and 403 keyword
    reference:
        - https://portswigger.net/daily-swig/symfony-based-websites-open-to-rce-attack-research-finds
        - https://medium.com/@m4cddr/how-i-got-rce-in-10-websites-26dd87441f22
        - https://al1z4deh.medium.com/how-i-hacked-28-sites-at-once-rce-5458211048d5
        - https://github.com/ambionics/symfony-exploits
    metadata:
        verified: true
        shodan-query: http.html:"symfony Profiler"
    tags: symfony, _fragment, misconfig
requests:
    - method: GET
      path: 
        - '{{BaseURL}}/_fragment'
        
      matchers-condition: and
      matchers:
        - type: word
          part: body
          words: 
            - 'Symfony'
            - '403 Forbidden'

        - type: status
          status:
            - 200
            - 403
