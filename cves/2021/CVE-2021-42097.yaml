id: cve-2021-42097
info:
  name: GNU Mailman Remote Privilege Escalation
  author: Matt Galligan
  severity: high
  description: GNU Mailman < 2.1.35 Privesc / CSRF Token Bypass
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2021-42097
    - https://access.redhat.com/errata/RHSA-2021:4913
    - https://mail.python.org/archives/list/mailman-announce@python.org/thread/IKCO6JU755AP5G5TKMBJL6IEZQTTNPDQ/
requests:
  - method: GET
    path:
      - "{{BaseURL}}/mailman/listinfo"
      - "{{BaseURL}}/listinfo"
    matchers-condition: and
    matchers:
      - type: word
        words:
          - Delivered by Mailman
      - type: dsl
        dsl:
          - to_string(version) < "2.1.35"
    extractors:
      - type: regex
        name: version
        internal: true
        group: 1
        regex:
          - (?m)version ([0-9.]+)
