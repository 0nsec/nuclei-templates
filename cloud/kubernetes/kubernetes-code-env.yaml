id: kubernetes-code-env
info:
  name: Kubernetes Cluster Validation
  author: princechaddha
  severity: info
  description: |
    Checks if kubernetes CLI is set up and all necessary tools are installed on the environment.
  reference:
    - https://kubernetes.io/
  tags: cloud,devops,kubernetes,k8s,k8s-cluster-security

self-contained: true
code:
  - engine:
      - sh
      - bash
    source: |
      kubectl version

    extractors:
      - type: regex
        internal: true
        name: server_version
        group: 1
        regex:
          - 'Server Version:\s*(v[0-9]+\.[0-9]+\.[0-9]+)'

      - type: dsl
        dsl:
          - '"kubectl is successfully connected to the Kubernetes API Server Version: " + server_version'
# digest: 490a00463044022060f6b35656b085acb63c43f19676499fa16fe76f2e7128f1e8d6389798d6bbcd02201585e64076231a9e59d824bbd144fa66f46b7304db8d6cf4b3f41e04d7bc2e42:922c64590222798bb761d5b6d8e72950