id: multi-region-logging-disabled

info:
  name: Global Service (Multi-Region) Logging - Disabled
  author: DhiyaneshDK
  severity: high
  description: |
    Global Service (Multi-Region) Logging is disabled, preventing the collection and monitoring of logs across multiple regions. This lack of centralized logging increases the risk of undetected security incidents and operational issues.
  reference:
    - https://www.trendmicro.com/cloudoneconformity/knowledge-base/alibaba-cloud/AlibabaCloud-ActionTrail/enable-multi-region-trails.html
    - https://www.alibabacloud.com/help/en/actiontrail/product-overview/services-that-work-with-actiontrail
  metadata:
    max-request: 1
    verified: true
  tags: cloud,devops,aliyun,alibaba,aliyun-cloud-config,actiontrail

variables:
  region: "cn-hangzhou"

self-contained: true

code:
  - engine:
      - sh
      - bash

    source: |
      aliyun actiontrail DescribeTrails --region $region

    matchers-condition: and
    matchers:
      - type: word
        words:
          - '"TrailRegion": "All"'
        negative: true

      - type: word
        words:
          - '"Status": "Enable"'

    extractors:
      - type: dsl
        dsl:
          - '"ActionTrail for Global Service Multi-Region is Disabled "'
# digest: 4b0a004830460221008437fab45e566bd35465507497b8b128612b8413758c19dc5a39aa796d27d4fc022100861a65bcb232af687c19f85fceeda397a1d21ec2bc214b35fe754c09be97a595:922c64590222798bb761d5b6d8e72950