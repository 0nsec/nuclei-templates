id: rsync-list-modules

info:
  name: Rsync List Modules
  author: pussycat0x
  severity: low
  description: |
    Lists modules available for rsync (remote file sync) synchronization.
  reference:
    - https://nmap.org/nsedoc/scripts/rsync-list-modules.html
  metadata:
    verified: true
    shodan-query: port:873
    max-request: 1
  tags: network,rsync,enum

javascript:
  - code: |
      const c = require("nuclei/net");
      let s = "@RSYNCD: 31.0\n\n"
      let conn = c.Open('tcp', `${Host}:${Port}`);
      conn.Send(s);
      response =(conn.RecvString(1024))
      response;

    args:
      Host: "{{Host}}"
      Port: 873

    matchers:
      - type: word
        words:
          - "RSYNCD: "

    extractors:
      - type: regex
        regex:
          - '(.*)'
