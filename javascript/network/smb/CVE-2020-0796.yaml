id: CVE-2020-0796

info:
  name: SMBGhost Vulnerability
  author: pussycat0x
  severity: unknown
  description: |
    SMBGhost, or CVE-2020-0796, is a vulnerability that resides within the Microsoft Server Message Block 3.0 (SMBv3), a protocol introduced by the company to its newer operating systems. This communication protocol enables shared access to files, data, and other assets within an interconnected computer network.
  reference:
    - https://msrc.microsoft.com/update-guide/en-US/advisory/CVE-2020-0796
  metadata:
    verified: true
    shodan-query: "port:445"
  tags: js,network,smb,enum

javascript:
  - code: |
      var m = require("nuclei/smb");
      var c = m.SMBClient();
      var response = c.DetectSMBGhost(Host, Port);
      log(to_json(response));

    args:
      Host: "{{Host}}"
      Port: "445"

    matchers:
      - type: word
        words:
          - "response == test"
          - "success == true"