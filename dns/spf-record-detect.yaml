id: spf-record-detect

info:
  name: SPF Record - Detection
  author: rxerium
  severity: info
  description: |
    An SPF TXT record was detected
  reference:
    - https://www.mimecast.com/content/how-to-create-an-spf-txt-record
  metadata:
    max-request: 1
  tags: dns,spf
dns:
  - name: "{{FQDN}}"
    type: TXT
    matchers:
      - type: word
        words:
          - "v=spf1"

    extractors:
      - type: regex
        regex:
          - "v=spf1(.+)"
# digest: 4a0a00473045022005b0b93d0a66bf3c3468f77bb21fe44431ce231a22a708dbe67ee5f0b7c2743d022100cc7c0ad0475e5524d7c8f51a0d36ace3ab0ac7e2e9ecfd8f5d8e7c1fe3b71a1a:922c64590222798bb761d5b6d8e72950