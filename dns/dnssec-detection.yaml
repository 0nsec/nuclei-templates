id: dnssec-detection

info:
  name: DNSSEC Detection
  author: pdteam
  severity: info
  description: Domain Name System Security Extensions (DNSSEC) are enabled. The Delegation of Signing (DS) record provides information about a signed zone file when DNSSEC enabled.
  reference:
    - https://www.icann.org/resources/pages/dnssec-what-is-it-why-important-2019-03-05-en
    - https://www.cyberciti.biz/faq/unix-linux-test-and-validate-dnssec-using-dig-command-line/
  classification:
    cwe-id: CWE-200
  metadata:
    max-request: 1
  tags: dns,dnssec

dns:
  - name: "{{FQDN}}"
    type: DS
    matchers:
      - type: regex
        part: answer
        regex:
          - "IN\tDS\\t(.+)$"
# digest: 4a0a0047304502200f1a078d812670782633112995992b06c770300e158cc2bb188dc4fc7a6f2b5e022100b36b93704063248a6de842c57834cb6f810cf377020671738948213db5c86f8f:922c64590222798bb761d5b6d8e72950