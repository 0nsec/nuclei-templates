id: quasar-rat-c2

info:
  name: Detect SSL Certificate Quasar RAT C2
  author: johnk3r
  severity: info
  description: |
    Quasar RAT is a malware family written in .NET which is used by a variety of attackers. The malware is fully functional and open source, and is often packed to make analysis of the source more difficult.
  reference: |
    https://malpedia.caad.fkie.fraunhofer.de/details/win.quasar_rat
  metadata:
    max-request: 1
    verified: "true"
    shodan-query: ssl.cert.subject.cn:"Quasar Server CA"
  tags: c2,ir,osint,malware

ssl:
  - address: "{{Host}}:{{Port}}"

    matchers:
      - type: word
        part: issuer_cn
        words:
          - "Quasar Server CA"

    extractors:
      - type: json
        json:
          - " .issuer_cn"
