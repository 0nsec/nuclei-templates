id: admin-account-rename

info:
  name: Administrator Account Rename Check
  author: nukunga[SungHyunJeon]
  severity: medium
  description: Verify if the built-in Administrator account has been renamed to prevent targeted brute-force attacks.
  impact: |
    Using default Administrator account name allows attackers to focus password guessing efforts on a known privileged account.
  remediation: |
    Rename Administrator account via Local Security Policy or CLI command:
    > wmic UserAccount where Name="administrator" call Rename Name="NEW_NAME"
  tags: windows, account-management, security

self-contained: true

code:
  - pre-condition: |
      IsWindows();
    engine: 
      - powershell
      - powershell.exe
    args:
      - -ExecutionPolicy
      - Bypass
    pattern: "*.ps1"
    source: |
      # Check SID ending with -500 (built-in Administrator)
      $adminAccount = Get-LocalUser | Where-Object { $_.SID -like '*-500' }
      
      if ($adminAccount.Name -eq 'Administrator') {
          "ADMINISTRATOR_ACCOUNT_NOT_RENAMED"
      } else {
          "ADMINISTRATOR_ACCOUNT_RENAMED"
      }

    matchers:
      - type: word
        words:
          - "ADMINISTRATOR_ACCOUNT_NOT_RENAMED"
# digest: 4b0a00483046022100aedbadc1753c7d70f7dde832ea02a9c480bee1deb9a1e08a1f37659374658636022100ae0751885835901af722daa915db1b37bc893fda15d330f755e77403917060ee:3bd7ba8113bb8138bfd3703bfad1917a