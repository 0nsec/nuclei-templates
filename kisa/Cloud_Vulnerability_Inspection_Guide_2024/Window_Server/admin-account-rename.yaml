id: admin-account-rename

info:
  name: Administrator Account Rename Check
  author: nukunga[SungHyunJeon]
  severity: medium
  description: Verify if the built-in Administrator account has been renamed to prevent targeted brute-force attacks.
  impact: |
    Using default Administrator account name allows attackers to focus password guessing efforts on a known privileged account.
  remediation: |
    Rename Administrator account via Local Security Policy or CLI command:
    > wmic UserAccount where Name="administrator" call Rename Name="NEW_NAME"
  tags: windows,account-management,code,windows-audit,kisa

self-contained: true

code:
  - pre-condition: |
      IsWindows();
    engine:
      - powershell
      - powershell.exe
    args:
      - -ExecutionPolicy
      - Bypass
    pattern: "*.ps1"
    source: |
      # Check SID ending with -500 (built-in Administrator)
      $adminAccount = Get-LocalUser | Where-Object { $_.SID -like '*-500' }
      if ($adminAccount.Name -eq 'Administrator') {
          "ADMINISTRATOR_ACCOUNT_NOT_RENAMED"
      } else {
          "ADMINISTRATOR_ACCOUNT_RENAMED"
      }

    matchers:
      - type: word
        words:
          - "ADMINISTRATOR_ACCOUNT_NOT_RENAMED"