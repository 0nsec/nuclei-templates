id: macshell-c2-jarm

info:
  name: Macshell C2 JARM - Detect
  author: pussycat0x
  severity: info
  description: |
    MacShellSwift is a proof of concept MacOS post-exploitation tool written in Swift using encrypted sockets. This tool has been tested both pre and post-Catalina. I rewrote a prior tool of mine MacShell (one of my repos) and changed the client to Swift instead of python. This tool consists of two parts: a server script and a client binary. I wrote this tool to help blue teamers proactively guage detections against macOS post-exploitation methods that use macOS internal calls. Red teams can also find this of use for getting ideas around using Swift for macOS post-exploitation
  reference:
    - https://github.com/cedowens/C2-JARM
    - https://github.com/cedowens/MacShellSwift
  metadata:
    max-request: 1
  tags: jarm,network,c2,ir,osint,cti,macshell,tcp
tcp:
  - inputs:
      - data: 2E
        type: hex
    host:
      - "{{Hostname}}"
    matchers:
      - type: dsl
        dsl:
          - "jarm(Hostname) == '2ad000000000000000000000000000eeebf944d0b023a00f510f06a29b4f46'"
# digest: 4a0a0047304502206807af4bb292b9b4731943c37b24709f93eaa8e712d505928a5bb3e1d3453e340221009030858b10dc9be834136f800e467f6126c1ea0a9478a811d0cab72e6a68ae03:922c64590222798bb761d5b6d8e72950