id: jdwp-detect

info:
  name: Java Debug Wire Protocol - Detect
  author: johnk3r
  severity: info
  description: |
    JDWP, short for Java Debug Wire Protocol, is a standard feature in the Java platform, designed to help developers debug live applications. It allows remote inspection of threads, memory, and execution flow without restarting the application. To enable it, developers typically start the JVM with a flag like the one below. This setup tells the JVM to listen for debugger connections on port 5005 and accept incoming connections on all interfaces.
  reference:
    - https://www.wiz.io/blog/exposed-jdwp-exploited-in-the-wild
  tags: network,jdwp,tcp

tcp:
  - host:
      - "{{Hostname}}"
    port: 5005
    inputs:
      - data: "4a4457502d48616e647368616b65"  # JDWP-Handshake
        type: hex
        read: 14                             # wait for handshake reply

      - data: "0000000b00000001000101"        # JDWP command: VirtualMachine.Version
        type: hex
        read: 1024                            # wait for VM version response

    matchers:
      - type: regex
        part: raw
        regex:
          - "JVM version\\x20[0-9.]+\\x20\\(OpenJDK"

    extractors:
      - type: regex
        name: jdwp-version
        part: raw
        regex:
          - "JVM version ([0-9\\.]+) \\((OpenJDK[^)]+)\\)"
