id: starttls-mail-detect

info:
  name: STARTTLS Mail Server Detection
  author: r3dg33k,userdehghani
  severity: info
  description: |
    STARTTLS is an email protocol command that tells an email server that an email client, including an email client running in a web browser, wants to turn an existing insecure connection into a secure one.
  metadata:
    max-request: 1
  tags: mail,starttls,network,detect,smtp,detection,tcp

tcp:
  - inputs:
      - data: "65686c6f20636865636b746c730a"
        type: hex
    read-size: 2048

    host:
      - "{{Hostname}}"
    port: 25,2525,465,587

    matchers:
      - type: word
        words:
          - "250-STARTTLS"
# digest: 4b0a00483046022100e89306e3fa803683205d9af47992d6533c0b90180e7d94e2abd35fa245e4f11c022100864b42d937cd3815b56d51c25a4945f13a2c950868b8a5909a23fb49d001f48a:922c64590222798bb761d5b6d8e72950