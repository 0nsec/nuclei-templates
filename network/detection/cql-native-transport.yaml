id: cql-native-transport

info:
  name: CQL Native Transport Detect
  author: pussycat0x
  severity: info
  description: |
    Native transport requests (NTR) are any requests made via the CQL Native Protocol. CQL Native Protocol is the way the Cassandra driver communicates with the server.
  metadata:
    verified: true
    max-request: 1
    shodan-query: cassandra
  tags: network,cassandra,cql,detect,detection,tcp
tcp:
  - inputs:
      - data: "/n"
      - data: "/n"
      - data: "/n"
      - data: "/n"
      - data: "/n"
      - data: "/n"
      - data: "/n"
      - data: "/n"

    host:
      - "{{Hostname}}"
    port: 9042

    matchers:
      - type: word
        words:
          - "valid or unsupported protocol"

    extractors:
      - type: regex
        regex:
          - "protocol version: ([0-9]+)"
# digest: 4a0a00473045022100d7aa893d565b69183b82f054b9fcc4977040a1b142fdafc563ad3b39b24347450220076b55f8ec791a93f549e1290b91e4339a08fe7ace6a4a76738f1249fbf270aa:922c64590222798bb761d5b6d8e72950