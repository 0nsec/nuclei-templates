id: rlos-cabinet-detect
info:
  name: Exposed Cabinet Management Panel - Retail Loan Origination System
  author: noel
  severity: Medium
  description: Retail Loan Origination Systems,developed by NewGen Software is used to streamline consumer loan origination from banking institutions, with end-to-end automation of loan requests in a paperless environment. A Cabinet Panel is used by an RLOS Service to manage storage volumes, that in turn store documents, containing customer PII submitted through the webapp. The RLOS Web Application is deployed on a special service subdomain on of the client's domain infrastructure - with the suffix â€œrlos" (for example - rlos.company.com) . The path to the Cabinet Storage is omniapp/pages/cabinet/managecabinet.jsf?Action=1. If exposed, it gives an attacker insight into information such as Storage Volume Name, Cabinet Name, it's alias, Deployed AppServer IP Address and Port
  impact: |
    An attacker can deploy foreign application server instances on the panel using breached credentials for the subdomain, access information about the volume storage and escalate the misconfiguration, by de-registering existing storage systems, so as to route all documents submitted through the platform on an adversary-controlled application server, potentially leading to further compromise.
  metadata:
   verified: true
   tags: info,detection
http:
  - method: GET
    path:
      - '{{BaseURL}}/omniapp/pages/cabinet/managecabinet.jsf?Action=1'
      - '{{BaseURL}}'
    stop-at-first-match: false
    matchers-condition: and
    matchers:
      - type: word
        words:
          - 'Manage Cabinet [Register Cabinet]'
      - type: status
        status:
          - 200