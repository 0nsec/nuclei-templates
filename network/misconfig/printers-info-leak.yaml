id: printers-info-leak

info:
  name: Unauthorized Printer Access
  author: pussycat0x
  severity: info
  description: |
    Unauthorized access to printers allows attackers to print, eavesdrop sensitive documents.
  reference:
    - https://book.hacktricks.xyz/pentesting/9100-pjl
  metadata:
    max-request: 1
  tags: network,iot,printer,misconfig,tcp
tcp:
  - inputs:
      - data: "@PJL INFO ID\n"
    host:
      - "{{Hostname}}"
    port: 9100

    matchers:
      - type: binary
        binary:
          - "40504a4c20494e464f2049440d0a22"

    extractors:
      - type: regex
        group: 1
        regex:
          - '"([^"]+)"'
