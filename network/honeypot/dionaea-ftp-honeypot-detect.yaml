id: dionaea-ftp-honeypot-detect

info:
  name: Dionaea FTP Honeypot - Detect
  author: UnaPibaGeek
  severity: info
  description: |
    A Dionaea FTP honeypot has been identified.
    The response to the 'PASS' command differs from real installations, signaling a possible deceptive setup.
  metadata:
    max-request: 1
    product: ftp
    vendor: dionaea
  tags: dionaea,ftp,honeypot,ir,cti,network

tcp:
  - inputs:
      - data: "USER root\r\n"
        read: 1024
      - data: "PASS \r\n"
        read: 1024

    host:
      - "{{Hostname}}"
    port: 21
    read-size: 2048

    matchers:
      - type: word
        words:
          - "500 Syntax error: PASS requires an argument"
# digest: 4b0a00483046022100988d1753744d906f7638938fffee9c0b57dfb8742b822fcc5d2cfb1a8d3395f6022100e4509e0049898154fd9321e3c190a03bd6cc2a1fe92f9eb9dd0e3d63135cfdb4:922c64590222798bb761d5b6d8e72950