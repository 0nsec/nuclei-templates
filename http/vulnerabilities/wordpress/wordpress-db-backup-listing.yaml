id: wordpress-db-backup-listing

info:
  name: WordPress DB Backup
  author: Suman_Kar
  severity: medium
  description: WordPress DB Backup plugin exposes db file along with directory listing.
  metadata:
    max-request: 1
  tags: wordpress,backup

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/uploads/database-backups/"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "Index of /"
          - "wp-content/uploads/database-backups"
          - ".sql"
        condition: and
        part: body

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100b3fbae37137dc44c11fbb8fdcff74bbc49ca9a0ef74f18a7c40801e3957866390221009560e244d10c3524aea875c5498e1dff950855b7d9384f80b5e4b05166a1c7c1:922c64590222798bb761d5b6d8e72950