id: oob-param-based-interaction

info:
  name: Parameter Based Generic OOB Interaction
  author: pdteam
  severity: info
  description: The remote server fetched a spoofed URL from the request parameters.
  reference:
    - https://github.com/PortSwigger/collaborator-everywhere
  metadata:
    max-request: 1
  tags: oast,ssrf,generic

http:
  - method: GET
    path:
      - "{{BaseURL}}/?u=http://{{interactsh-url}}/&href=http://{{interactsh-url}}/&action=http://{{interactsh-url}}/&host={{interactsh-url}}&http_host={{interactsh-url}}&email=root@{{interactsh-url}}&url=http://{{interactsh-url}}/&load=http://{{interactsh-url}}/&preview=http://{{interactsh-url}}/&target=http://{{interactsh-url}}/&proxy=http://{{interactsh-url}}/&from=http://{{interactsh-url}}/&src=http://{{interactsh-url}}/&ref=http://{{interactsh-url}}/&referrer=http://{{interactsh-url}}/"

    matchers:
      - type: word
        part: interactsh_protocol
        name: http
        words:
          - "http"
# digest: 4a0a00473045022100f94c89e6fa364a7a3420052d5e9f96dd1100cab590d52f4d017431808f8994990220553e42ac57b5611d640758ced89a171715fee8365d5f1ed56744ae5a283a8030:922c64590222798bb761d5b6d8e72950