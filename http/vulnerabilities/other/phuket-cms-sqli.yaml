id: phuket-cms-sqli

info:
  name: Phuket Solution CMS - SQL Injection
  author: r3Y3r53
  severity: high
  description: |
    Phuket Solutions CMS is vulnerable to sql injection in which an attacker is able to manipulate an SQL query through user input, causing the application to execute unintended SQL code.
  reference:
    - https://www.exploitalert.com/view-details.html?id=36234
  metadata:
    verified: true
    max-request: 2
    google-query: intext:"Developed by Phuket Solution"
  tags: phuket,sqli,phuket-cms

http:
  - raw:
      - |
        GET /properties-list.php HTTP/1.1
        Host: {{Hostname}}
      - |
        GET /properties-list.php?property-types=%27 HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'status_code_2 == 200'
          - 'contains(content_type_2, "text/html")'
          - 'contains(body_2, "You have an error in your SQL syntax") && contains(body_1, "Phuket Solution")'
        condition: and
# digest: 490a0046304402205aee10a1f13c8f4ce48e9dc9ba5e9fe71d9c9fae7f5a61490f8034cf65a447d60220282010a885fb320629b1bed15a24dfd7c1c9b3071d93561e243baac7bc052d70:922c64590222798bb761d5b6d8e72950