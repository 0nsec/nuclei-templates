id: idocview-2word-fileupload

info:
  name: IDoc View /html/2word - Arbitrary File Upload
  author: DhiyaneshDK
  severity: high
  metadata:
    verified: true
    max-request: 1
    fofa-query: title=="在线文档预览 - I Doc View"
  tags: idoc,rce,instrusive,file-upload

variables:
  file: "{{to_lower(rand_text_alpha(5))}}"

http:
  - method: GET
    path:
      - "{{BaseURL}}/html/2word?url={{file}}"

    matchers-condition: and
    matchers:
      - type: word
        part: response
        words:
          - "{{md5(file)}}.docx"

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100dcef74161e0e4caf985a0e7e487a0be74571ac60d1c785f6128da16ce90f7b53022100c7f5c586c009ff4b0ee335b9de9d1e6bec6abac01376f1ccb0f806daf154e612:922c64590222798bb761d5b6d8e72950