id: defacement-detect

info:
  name: Defacement Content - Detection
  author: ricardomaia
  severity: info
  description: |
    This template detects defacement content in the response body, using a list of commom paths as payload.It also detects spamdexing and hacktivism signatures and extracts a text snippet with the match.The URL paths and regex rules were based on research from several sources.Other rules are based in the author's experience and are not exhaustive.
  reference:
    - https://www.zone-h.org
    - https://zone-xsec.com
    - https://hax.or.id
    - https://www.haxor.id
    - https://www.defacer.net
    - https://www.radware.com/security/threat-advisories-and-attack-reports/hacktivism-unveiled-april-2023
  metadata:
    verified: true
  tags: misc,defacement,spam,hacktivism,osint

http:
  - method: GET
    path:
      - "{{BaseURL}}{{path}}"

    redirects: true
    max-redirects: 1

    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        name: defacement-signature
        regex:
          - '(?i)\bhack[e|3]d.?(by)?\b'
          - '(?i)\bwh(00|oo)pz\b'
          - '(?i)\bdefaced.?(by)?\b'
          - '(?i)\bPa?wn(e|3)d.?(by)?\b'
          - '(?i)\b0wned.?(by)?\b'
          - '(?i)\bGreetz.?(to)?\b'
          - '(?i)\bXploit\b'
          - '(?i)\brulez\b'
          - '(?i)\buid=0(root).?gid=0(root).?groups=0(root)\b'
          - '(?i)\bh(a|4)x(o|0)r\b'
          - '(?i)\bHack.Team\b'
          - '(?i)\bpwnted.?(by)?\b'
          - '(?i)\bBUY.WEBSHELL\b'
          - '(?i)\bHello.Admin\b'
          - '(?i)\bShootz\b'

      - type: regex
        part: body
        name: spamdexing
        regex:
          - '(?i)\bcialis\b'
          - '(?i)\btadacip\b'
          - '(?i)\bpurinethol\b'
          - '(?i)\bbactrim\b'
          - '(?i)\bfemale-cialis\b'
          - '(?i)\btoprol-xl\b'
          - '(?i)\bbupropion\b'
          - '(?i)\blevitra\b'
          - '(?i)\bfeldene\b'
          - '(?i)\bapcalis\b'
          - '(?i)\batacand\b'
          - '(?i)\bzerit\b'
          - '(?i)\bisordil\b'
          - '(?i)\bviagra-soft\b'
          - '(?i)\bdanazol\b'
          - '(?i)\blasix\b'
          - '(?i)\bapcalis-sx\b'
          - '(?i)\btadalafil\b'
          - '(?i)\bviagra-jelly\b'
          - '(?i)\btadalis-sx\b'
          - '(?i)\btelmisartan\b'
          - '(?i)\bcialis-soft\b'
          - '(?i)\brevia\b'
          - '(?i)\bcardura\b'
          - '(?i)\bfempro\b'
          - '(?i)\bfemale-viagra\b'
          - '(?i)\berectalis\b'
          - '(?i)\bforzest\b'
          - '(?i)\bisoptin-sr\b'
          - '(?i)\bkamagra-soft\b'
          - '(?i)\blioresal\b'
          - '(?i)\bneoral\b'
          - '(?i)\bcytoxan\b'
          - '(?i)\bphenytoin\b'
          - '(?i)\bvibramycin\b'
          - '(?i)\binstant.fortune\b'
          - '(?i)\win.the.lottery\b'
          - '(?i)\bwin.the.lotto\b'
          - '(?i)\bcassino\b'

      - type: regex
        part: body
        name: zone-h-top-50
        regex:
          - '(?i)\bHmei7\b'
          - '(?i)\bd3b~x\b'
          - '(?i)\bIndex Php\b'
          - '(?i)\biskorpitx\b'
          - '(?i)\bchinafans\b'
          - '(?i)\bSejeal\b'
          - '(?i)\b1923Turk\b'
          - '(?i)\bmuhmademad\b'
          - '(?i)\bTeam_CC\b'
          - '(?i)\bimam\b'
          - '(?i)\bmisafir\b'
          - '(?i)\bZoRRoKiN\b'
          - '(?i)\bpanataran\b'
          - '(?i)\bGHoST61\b'
          - '(?i)\bAshiyane Digital Security Team\b'
          - '(?i)\bFatal Error\b'
          - '(?i)\bErrOr SquaD\b'
          - '(?i)\bw4l3xzy3\b'
          - '(?i)\bBD GREY HAT HACKERS\b'
          - '(?i)\bSA3D HaCk3D\b'
          - '(?i)\bjok3r\b'
          - '(?i)\bHighTech\b'
          - '(?i)\bMr.Kro0oz\b'
          - '(?i)\bTheWayEnd\b'
          - '(?i)\bLUN4T1C0\b'
          - '(?i)\bKaMtiEz\b'
          - '(?i)\bHolaKo\b'
          - '(?i)\bMiSh\b'
          - '(?i)\bMister Spy\b'
          - '(?i)\bClash Hackers\b'
          - '(?i)\bKkK1337\b'
          - '(?i)\bKuroi\b'
          - '(?i)\bBALA SNIPER\b'
          - '(?i)\bRayzky_\b'
          - '(?i)\bRXR\b'
          - '(?i)\bTOP-TEAM\b'
          - '(?i)\bMagelang6etar\b'
          - '(?i)\bifactoryx\b'
          - '(?i)\bthe_warri0r\b'
          - '(?i)\bRed Eye\b'
          - '(?i)\bdarkshadow-tn\b'
          - '(?i)\bs13doeL\b'
          - '(?i)\bFallaga Team\b'
          - '(?i)\bulow\b'
          - '(?i)\bSPYKIDS\b'
          - '(?i)\bCyb3r_Sw0rd\b'
          - '(?i)\blinuXploit_crew\b'
          - '(?i)\bIr4dex 735\b'
          - '(?i)\bKingSam\b'

      - type: regex
        part: body
        name: other-groups-attacker
        regex:
          - '(?i)\bLapsus$\b'
          - '(?i)\bLulzSec\b'
          - '(?i)\bmilw0rm\b'
          - '(?i)\bNoName05\b'
          - '(?i)\bAnonymousSudan\b'
          - '(?i)\bAnon_by\b'
          - '(?i)\bAnonGhost\b'
          - '(?i)\bTeam.Insane\b'
          - '(?i)\bEagle Cyber\b'

      - type: regex
        part: body
        name: hacktivism-operation
        regex:
          - '(?i)\bOpIsrael\b'
          - '(?i)\bOpRussia\b'
          - '(?i)\bOpIran\b'
          - '(?i)\bOpPhilippines\b'
          - '(?i)\bOpAustralia\b'
          - '(?i)\bAnonymousItalia\b'
          - '(?i)\bStopRussia\b'
          - '(?i)\bStopInvasion\b'
          - '(?i)\bWe.are.legion\b'
          - '(?i)\bAnonOps\b'
          - '(?i)\bOpGOP\b'
          - '(?i)\bOpStonewall\b'
          - '(?i)\bTangoDown\b'
          - '(?i)\bFREE_PALESTINE\b'
          - '(?i)\bFREE_AL-AQSA\b'

      - type: status
        status:
          - 200

    payloads:
      path:
        - /
        - /old
        - /ssh
        - /tmp
        - /uploads
        - /index.html
        - /index.php
        - /indexx.html
        - /defaced.html
        - /readme.html
        - /readme.php
        - /kurd.html
        - /kurd1943.html
        - /evil.html
        - /ghost.htm
        - /pwnd.html
        - /pwn.html
        - /hacked.html
        - /hacked.txt
        - /1.php
        - /1.txt
        - /1.html
        - /a.htm
        - /a.html
        - /a.php
        - /V.txt
        - /0day.txt
        - /1337.txt
        - /r00t.php
        - /root.html
        - /id.htm
        - /by.html
        - /by.htm
        - /me.php
        - /o.htm
        - /O.html
        - /a.php
        - /a.html
        - /z.php
        - /zz.txt
        - /z.txt
        - /M.html
        - /ie.txt
        - /xxx.html
        - /x.txt
        - /logs.txt
        - /ownz.html
        - /update_note.txt
        - /k.html
        - /y.txt
        - /T.html
        - /ts.html
        - /tr.html
        - /core.html
        - /el.htm
        - /ie.htm
        - /si.html
        - /sad.html
        - /fake.html
        - /broken.html
        - /buy.html
        - /access.php
        - /info.php
        - /jquery.php
        - /news.php
        - /services.php
        - /boxed.php
        - /main.php
        - /pbw.txt
        - /aw.txt
        - /hx.txt
        - /vz.txt
        - /cl.html
        - /asi.html
        - /public
        - /cache
        - /info.txt
        - /ir.html
        - /me.html
        - /px.html
        - /px.php
        - /F.html
        - /frost.txt
        - /-.txt
        - /!.txt
