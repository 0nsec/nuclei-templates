id: openplc-webserver-v3-default-login

info:
  name: OpenPLC Webserver v3 - Default Login
  author: machevalia
  severity: high
  description: >
    Checks if OpenPLC is using default credentials (openplc:openplc) by logging in and accessing an authenticated endpoint.
  tags: iot,openplc,default-login,auth

http:
  - raw:
      - |
        POST /login HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        username=openplc&password=openplc

      - |
        GET /dashboard HTTP/1.1
        Host: {{Hostname}}

    cookie-reuse: true
    stop-at-first-match: false

    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "Dashboard"
          - "Runtime Logs"
        condition: and
