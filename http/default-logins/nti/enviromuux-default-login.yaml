id: enviromuux-default-login

info:
  name: Network Technologies Inc ENVIROMUX - Default Login
  author: M.Sarmad Shafiq
  severity: high
  description: |
    The ENVIROMUX environment monitoring system from Network Technologies Inc was found to be using its default login credentials. This default configuration could have allowed unauthorized users to gain access to the web management interface without authentication, potentially leading to information disclosure or unauthorized control over environmental monitoring systems.
  reference:
    - http://www.networktechinc.com/download/d-environment-monitor-16.html
    - http://www.networktechinc.com/pdf/man154.pdf
  metadata:
    verified: true
    max-request: 1
    shodan-query: html:"ENVIROMUX"
    fofa-query: body="ENVIROMUX"
  tags: default-login,networktechnologies,enviromux

variables:
  username: "root"
  password: "nti"

http:
  - raw:
      - |
        POST /goform/login HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        username={{username}}&password={{password}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"success":"true"'
          - '"cookie":"sessionId='
        condition: and

      - type: status
        status:
          - 200
