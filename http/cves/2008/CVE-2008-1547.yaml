id: CVE-2008-1547

info:
  name: Microsoft OWA Exchange Server 2003 - 'redir.asp' Open Redirection
  author: ctflearner
  severity: medium
  description: |
    Open redirect vulnerability in exchweb/bin/redir.asp in Microsoft Outlook Web Access (OWA) for Exchange Server 2003 SP2 (aka build 6.5.7638) allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks via a URL in the URL parameter.
  remediation: |
    Apply the necessary security patches or upgrade to a newer version of Microsoft Exchange Server.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2008-1547
    - https://www.exploit-db.com/exploits/32489
    - http://securityreason.com/securityalert/4441
    - https://exchange.xforce.ibmcloud.com/vulnerabilities/46061
  classification:
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N
    cvss-score: 4.3
    cve-id: CVE-2008-1547
    cwe-id: CWE-601
    epss-score: 0.03523
    epss-percentile: 0.90483
    cpe: cpe:2.3:a:microsoft:exchange_server:2003:sp2:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: microsoft
    product: exchange_server
    shodan-query: http.title:"Outlook"
  tags: cve,cve2008,redirect,owa,exchange,microsoft

http:
  - method: GET
    path:
      - "{{BaseURL}}/exchweb/bin/redir.asp?URL=https://interact.sh"
      - "{{BaseURL}}/CookieAuth.dll?GetLogon?url=%2Fexchweb%2Fbin%2Fredir.asp%3FURL%3Dhttps%3A%2F%2Finteract.sh&reason=0"

    stop-at-first-match: true
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?://|//)(?:[a-zA-Z0-9\-_\.@]*)interact\.sh.*$'

# digest: 4a0a0047304502200b9687bde96db0e3b6f93ac4ef0e94209fae0fc710184ec8ff6c8840eba128be022100e5f79a4cd7b04fb34a7d775fcb5a13dc49584ba2a668f58d0a0102a216e89d51:922c64590222798bb761d5b6d8e72950
