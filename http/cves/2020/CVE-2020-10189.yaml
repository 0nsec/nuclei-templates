id: CVE-2020-10189

info:
  name: ManageEngine Desktop Central Java Deserialization
  author: king-alexander
  severity: critical
  remediation: Apply updates per vendor instructions. 
  description: This template detects the presence of a Java deserialization vulnerability within verisions below 10.0.474.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-10189
    - https://packetstormsecurity.com/files/156730/ManageEngine-Desktop-Central-Java-Deserialization.html
    - https://www.manageengine.com/products/desktop-central/remote-code-execution-vulnerability.html
  tags: cve,cve2020,kev

http:
  - method: GET
    path:
      - "https://{{Host}}:8383/configurations.do"

    extractors:
      - type: regex
        name: version
        internal: true
        group: 1
        regex:
          - "^([0-9.]+)?([0-9.]+)?([0-9]+)$"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "ManageEngine Desktop Central"

      - type: dsl
        dsl:
          - compare_versions(version, '<10.0.474')
