id: CVE-2010-1586
info:
  name: HP System Management Homepage (SMH) v2.x.x.x - Open Redirect
  description: | 
    .Open redirect vulnerability in red2301.html in HP System Management Homepage (SMH) 2.x.x.x allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks via the RedirectUrl parameter.
  author: ctflearner
  severity: medium
  tags: 
     - HP System Management Homepage (SMH)
     - Open redirect
     - web
     - cve2010
  reference:
    - https://www.exploit-db.com/exploits/33873
    - https://yehg.net/lab/pr0js/advisories/hp_system_management_homepage_url_redirection_abuse
    - https://nvd.nist.gov/vuln/detail/CVE-2010-1586
    - https://exchange.xforce.ibmcloud.com/vulnerabilities/58107
  classification:
    cvss-metrics: CVSS:2.0/(AV:N/AC:M/Au:N/C:N/I:P/A:N)
    cvss-score: 4.3
    cve-id: CVE-2010-1586
    cwe-id: CWE-20
    cpe: cpe:2.3:a:hp:system_management_homepage:2.2.8:*:*:*:*:*:*:*
  
  metadata:
    max-request: 1

http:
  - method: GET
    path:
      - "{{BaseURL}}/red2301.html?RedirectUrl=http://www.evil.com"
    
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)?(?:[a-zA-Z0-9\-_\.@]*)evil\.com\/?(\/|[^.].*)?$'
      - type: status
        status:
          - 301
          - 302
          - 307
          - 308
        condition: or
