id: CVE-2023-45024

info:
  name: Best Practical Request Tracker (RT) Information Disclosure via Transaction Query Builder
  author: burso
  severity: high
  description: |
    Best Practical Request Tracker (RT) versions prior to 5.0.5 are vulnerable to information disclosure through the transaction query builder. 
    This flaw allows authenticated users to perform transaction searches that may inadvertently expose sensitive information.
  tags: panel, request-tracker, bps, best-practical-solutions, cve-2023-45024, information-disclosure
  reference: https://nvd.nist.gov/vuln/detail/cve-2023-45024
  metadata:
    shodan-query: 'vuln:CVE-2023-45024'

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
        User-Agent: nuclei

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - '<p id="version"[^>]*><span>RT Version ([^<]*)</span></p>'
        part: body
      - type: dsl
        dsl:
          - |
            compare_versions(rt_version, ">=5.0.0", "<5.0.5")

    extractors:
      - type: regex
        name: rt_version
        regex:
          - '<p id="version"[^>]*><span>RT Version ([^<]*)</span></p>'
        group: 1
