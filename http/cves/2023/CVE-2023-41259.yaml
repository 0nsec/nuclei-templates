id: CVE-2023-41259

info:
  name: Best Practical Request Tracker (RT) Information Disclosure via Spoofed Email Headers
  author: burso
  severity: high
  description: |
    Best Practical Request Tracker (RT) versions prior to 4.4.7 and 5.x before 5.0.5 are vulnerable to information disclosure 
    through the acceptance of fake or spoofed RT email headers in incoming emails and the mail-gateway REST API interface.
    This flaw could allow unauthorized actors to access sensitive information by exploiting unvalidated email headers.
  tags: panel, request-tracker, bps, best-practical-solutions, cve-2023-41259, information-disclosure, email-header-spoofing
  reference: https://nvd.nist.gov/vuln/detail/cve-2023-41259
  metadata:
    shodan-query: 'vuln:CVE-2023-41259'

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
        User-Agent: nuclei

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - '<p id="version"[^>]*><span>RT Version ([^<]*)</span></p>'
        part: body
      - type: dsl
        dsl:
          - |
            compare_versions(rt_version, "<4.4.7") ||
            compare_versions(rt_version, ">=5.0.0", "<5.0.5")

    extractors:
      - type: regex
        name: rt_version
        regex:
          - '<p id="version"[^>]*><span>RT Version ([^<]*)</span></p>'
        group: 1

