id: CVE-2023-50290

info:
  name: Apache Solr Host Environment Variables via Metrics API
  author: Banana69,DhiyaneshDK
  severity: high
  description: |-
    Exposure of Sensitive Information to an Unauthorized Actor vulnerability in Apache Solr.
    The Solr Metrics API publishes all unprotected environment variables available to each Apache Solr instance. Users are able to specify which environment variables to hide, however, the default list is designed to work for known secret Java system properties. Environment variables cannot be strictly defined in Solr, like Java system properties can be, and may be set for the entire host,unlike Java system properties which are set per-Java-proccess.
  remediation: Users are recommended to upgrade to version 9.3.0 or later, in which environment variables are not published via the Metrics API.
  reference:
    - https://solr.apache.org/security.html#cve-2023-50290-apache-solr-allows-read-access-to-host-environment-variables
    - https://x.com/sirifu4k1/status/1746755165066236216?s=20
  metadata:
    shodan-query: title:"Apache Solr"
  tags: cve,cve2023,apache,solr,info-leak

http:
  - method: GET
    path:
      - "{{BaseURL}}/solr/admin/metrics"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"responseHeader":'
          - '"solr.jetty":'
          - 'system.env'
        condition: and

      - type: word
        part: header
        words:
          - 'application/json'

      - type: status
        status:
          - 200
