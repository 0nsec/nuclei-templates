id: CVE-2021-38562

info:
  name: Best Practical Request Tracker (RT) Timing Attack Sensitive Information Disclosure 
  author: burso
  severity: high
  description: |
    Best Practical Request Tracker (RT) versions 4.2 before 4.2.17, 4.4 before 4.4.5, and 5.0 before 5.0.2 are vulnerable 
    to a timing attack in the lib/RT/REST2/Middleware/Auth.pm module, potentially allowing sensitive information disclosure.
  tags: panel, request-tracker, bps, best-practical-solutions, cve-2021-38562, timing-attack, information-exposure
  reference: https://nvd.nist.gov/vuln/detail/CVE-2021-38562
  metadata:
    shodan-query: 'vuln:CVE-2021-38562'

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
        User-Agent: nuclei

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - '<p id="version"[^>]*><span>RT Version ([^<]*)</span></p>'
        part: body
      - type: dsl
        dsl:
          - |
            compare_versions(rt_version, ">=4.2.0", "<4.2.17") ||
            compare_versions(rt_version, ">=4.4.0", "<4.4.5") ||
            compare_versions(rt_version, ">=5.0.0", "<5.0.2")

    extractors:
      - type: regex
        name: rt_version
        regex:
          - '<p id="version"[^>]*><span>RT Version ([^<]*)</span></p>'
        group: 1
