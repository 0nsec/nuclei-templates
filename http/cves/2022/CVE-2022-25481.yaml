id: CVE-2022-25481

info:
  name: ThinkPHP 5.0.24 - Information Disclosure
  author: caon
  severity: high
  description: |
    ThinkPHP 5.0.24 is susceptible to information disclosure. This version was configured without the PATHINFO parameter. This can allow an attacker to access all system environment parameters from index.php, thereby possibly obtaining sensitive information, modifying data, and/or executing unauthorized operations.
  remediation: |
    Upgrade to a patched version of ThinkPHP or apply the necessary security patches.
  reference:
    - https://github.com/Lyther/VulnDiscover/blob/master/Web/ThinkPHP_InfoLeak.md
    - https://nvd.nist.gov/vuln/detail/CVE-2022-25481
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2022-25481
    cwe-id: CWE-668
    epss-score: 0.01311
    epss-percentile: 0.84431
    cpe: cpe:2.3:a:thinkphp:thinkphp:5.0.24:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: thinkphp
    product: thinkphp
    shodan-query: title:"ThinkPHP"
  tags: cve,cve2022,thinkphp,exposure,oss

http:
  - method: GET
    path:
      - '{{BaseURL}}/index.php?s=example'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Exception"
          - "REQUEST_TIME"
          - "ThinkPHP Constants"
        condition: and

      - type: status
        status:
          - 200
          - 500
          - 404
        condition: or
# digest: 4a0a004730450221009cc6dca9c3ae0eab161d7775f14798d72a39b997aa5a7e7956186787cd69eb5f02203b2145ece04b31270c77b280557655d80baa09522c0d2ce1fa11e5eb1df68f1c:922c64590222798bb761d5b6d8e72950