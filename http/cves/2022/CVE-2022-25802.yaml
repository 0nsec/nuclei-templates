id: CVE-2022-25802

info:
  name: Best Practical Request Tracker (RT) Cross-Site Scripting Vulnerability
  author: burso
  severity: medium
  description: |
    Best Practical Request Tracker (RT) versions prior to 4.4.6 and 5.x before 5.0.3 are vulnerable to cross-site scripting (XSS) attacks via a crafted content type for an attachment.
  tags: panel, request-tracker, bps, best-practical-solutions, cve-2022-25802, xss
  reference: https://nvd.nist.gov/vuln/detail/cve-2022-25802
  metadata:
    shodan-query: 'vuln:CVE-2022-25802'

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
        User-Agent: nuclei

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - '<p id="version"[^>]*><span>RT Version ([^<]*)</span></p>'
        part: body
      - type: dsl
        dsl:
          - |
            compare_versions(rt_version, "<4.4.6") ||
            compare_versions(rt_version, ">=5.0.0", "<5.0.3")

    extractors:
      - type: regex
        name: rt_version
        regex:
          - '<p id="version"[^>]*><span>RT Version ([^<]*)</span></p>'
        group: 1

