id: CVE-2022-25803

info:
  name: Best Practical Request Tracker (RT) Open Redirect via Ticket Search
  author: burso
  severity: medium
  description: |
    Best Practical Request Tracker (RT) versions prior to 5.0.3 are vulnerable to an open redirect through the ticket search functionality.
    This flaw allows attackers to redirect users to arbitrary external sites by crafting malicious search queries, potentially facilitating phishing attacks or other malicious activities.
  tags: panel, request-tracker, bps, best-practical-solutions, cve-2022-25803
  reference: https://nvd.nist.gov/vuln/detail/cve-2022-25803
  metadata: 
    shodan-query: 'vuln:CVE-2022-25803'

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
        User-Agent: nuclei

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - '<p id="version"[^>]*><span>RT Version ([^<]*)</span></p>'
        part: body
      - type: dsl
        dsl:
          - compare_versions(rt_version, "<5.0.3")

    extractors:
      - type: regex
        name: rt_version
        regex:
          - '<p id="version"[^>]*><span>RT Version ([^<]*)</span></p>'
        group: 1

