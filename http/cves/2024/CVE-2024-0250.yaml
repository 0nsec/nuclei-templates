id: CVE-2024-0250
info:
  name: Analytics Insights for Google Analytics 4 < 6.3 - Open Redirect
  author: securityforeveryone.com
  severity: medium
  description: |
    The plugin is vulnerable to Open Redirect due to insufficient validation on the redirect oauth2callback.php file. This makes it possible for unauthenticated attackers to redirect users to potentially malicious sites if they can successfully trick them into performing an action.
  remediation: Fixed in 6.3
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=2024-0250
    - https://wpscan.com/vulnerability/321b07d1-692f-48e9-a8e5-a15b38efa979/
    - https://github.com/fkie-cad/nvd-json-data-feeds
  classification:
    epss-score: 0.00043
    epss-percentile: 0.0866
  metadata:
    publicwww-query: inurl:"/wp-content/plugins/analytics-insights
  tags: wpscan,redirect,oauth,wp-plugin,cve,cve2024

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/analytics-insights/tools/oauth2callback.php?state=https://oast.me/%3f&code=x"

    redirects: true
    max-redirects: 2
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_\.@]*)oast\.me.*$'
