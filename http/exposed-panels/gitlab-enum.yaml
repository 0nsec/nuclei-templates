id: gitlab-enum

info:
  name: GitLab Instance Explore and API Check
  author: Sujal Tuladhar
  severity: info
  description: |
    This template checks for GitLab instances by verifying if /explore and /api/v4/projects endpoints are accessible with a 200 response.
  tags: gitlab, api

requests:
  - method: GET
    path:
      - "{{BaseURL}}/explore"
    matchers:
      - type: status
        status:
          - 200
    extractors:
      - type: regex
        part: body
        regex:
          - "(?i)explore GitLab"

  - method: GET
    path:
      - "{{BaseURL}}/api/v4/projects"
    matchers:
      - type: status
        status:
          - 200
