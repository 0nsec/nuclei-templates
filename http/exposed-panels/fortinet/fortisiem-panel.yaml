id: fortisiem-panel

info:
  name: FortiSIEM Login Panel - Detect
  author: pussycat0x
  severity: info
  description: FortiSIEM login panel was detected.
  classification:
    cpe: cpe:2.3:a:fortinet:fortisiem:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    shodan-query: "http.favicon.hash:-1341442175"
    product: fortisiem
    vendor: fortinet
  tags: panel,fortisiem
flow: http(1) && http(2)
http:
  - method: GET
    path:
      - "{{BaseURL}}/phoenix/login.html"

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "status_code == 200"
          - "(\"426d365a42bbc67c092b9c2e49b336420f0559d1\" == sha1(body))"
        condition: and

  - method: GET
    path:
      - "{{BaseURL}}/phoenix/js/login.min.js"

    matchers:
      - type: word
        words:
          - "fortiSIEM_current_login_salt"
# digest: 490a0046304402200a886f5b091bc3ef925789a6930eb5141b0b820f89e7d0fa09077d0b3bb2bf5702201363f6db017911d565a07b22bc1cd71e850550e208dc8f27ae1e2f64d7bd055c:922c64590222798bb761d5b6d8e72950