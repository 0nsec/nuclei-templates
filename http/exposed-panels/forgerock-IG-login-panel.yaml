id: forgerock-ig-login

info:
  name: ForgeRock IG Login/Welcome Page Detection (Generic)
  author: r3dg33k
  severity: info
  description: Detects ForgeRock Identity Gateway login or welcome page and extracts version number
  tags: forgerock,ig,login,identity-gateway

requests:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers:
      - type: word
        words:
          - '<title>IG'
          - '<h1>Identity Gateway</h1>'
          - '<a href="https://www.forgerock.com/platform/" title="ForgeRock Identity Platform" class="breadcrumb">ForgeRock Identity Platformâ„¢</a>'
          - 'Welcome to Identity Gateway'
        condition: and

      - type: regex
        regex:
          - '<span class="copyright">Copyright [0-9]{4}(-[0-9]{4})? ForgeRock AS\.</span>'

    extractors:
      - type: regex
        name: ig_version
        regex:
          - 'Identity Gateway (\d+\.\d+(\.\d+)?)'   # Extracts version like 7.2 or 7.2.0
        part: body
