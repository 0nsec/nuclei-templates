id: tibco-mft-internet-server-login
info:
  name: Detect TIBCO MFT Internet Server Login Page
  author: Th3l0newolf
  severity: info
  description: |
    This template detects the login page of TIBCO MFT (Managed File Transfer) Internet Server. 
    It checks for unique HTML elements, headers, and specific response values to confirm the presence of the TIBCO MFT login portal.
  reference:
    - https://www.tibco.com/products/managed-file-transfer
  tags: tibco,mft,login,web,portal

requests:
  - method: GET
    path:
      - "{{BaseURL}}/"
      - "{{BaseURL}}/login"
      - "{{BaseURL}}/MFTIS/login.html"
      - "{{BaseURL}}/cfcc/login/login.jsp?forbidden=yes"
      - "{{BaseURL}}/cfcc/login/login.jsp"
      - "{{BaseURL}}/login/login.jsp"

    matchers:
      - type: word
        words:
          - "TIBCO Managed File Transfer Internet Server"
          - "MFT Internet Server Login"
          - "Powered by TIBCO MFT: TIBCO Software Inc. Copyright (c) 2003-2023. Cloud Software Group, Inc. All Rights Reserved. Confidential & Proprietary."
          - "Powered by TIBCO MFT: TIBCO Software Inc. Copyright (c) 2003-2020. TIBCO Software Inc. All Rights Reserved."
          - "Powered by TIBCO MFT: TIBCO Software Inc. Copyright (c) 2003-2021. TIBCO Software Inc. All Rights Reserved."
        condition: or

      - type: status
        status:
          - 200

      - type: regex
        regex:
          - "(?i)<title>.*MFT Internet Server.*</title>"

      - type: word
        part: "header"
        words:
          - "MFTServer"
          - "TIBCO MFT"
        condition: or
