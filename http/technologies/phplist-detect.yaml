id: phplist-detect

info:
  name: phpList
  author: ricardomaia
  severity: info
  description: phpList is an open source newsletter manager.

  classification:
    cpe: cpe:2.3:a:phplist:phplist

  metadata:
    reference:
      - https://www.phplist.org/

  tags: tech,phplist

http:
  - method: GET
    path:
      - "{{BaseURL}}/lists/"
      - "{{BaseURL}}/lists/admin/"
      - "{{BaseURL}}/phplist/"
      - "{{BaseURL}}/PHPList/"
      - "{{BaseURL}}/mailinglist/"
      - "{{BaseURL}}/newsletter/"
      - "{{BaseURL}}/admin/"
      - "{{BaseURL}}"
    stop-at-first-match: true
    max-redirects: 3
    matchers:
      - type: regex
        regex:
          - '(?i)<meta name="powered-by" content="phpList'

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - '(?i)version.((\d\.?)+)'
