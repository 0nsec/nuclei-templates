id: matrix-homeserver-detect

info:
  name: Matrix Homeserver version
  author: Davide Girardi
  severity: info
  description: Extract the Matrix homeserver name and version
  metadata:
    max-request: 1
  tags: tech,matrix

http:

  - method: GET
    redirects: true
    max-redirects: 2
    path:
      - "https://{{Host}}/_matrix/federation/v1/version"

    extractors:
      - type: json
        part: body
        json:
          - '.server | select((.name != null) and (.version != null)) | .name, .version'
