id: detect-caobox-cms

info:
  name: Caobox CMS Detection
  author: Chirag Mistry
  reference:
    - https://www.linkedin.com/in/chirag-mistry-
  severity: info
  tags: detection,caobox,cms

metadata:
  verified: true
  max-request: 4
  vendor: caobox
  product: caobox
  shodan-query:
    - http.component:"Caobox"
    - http.component:"caobox"
    - cpe:"cpe:2.3:a:caobox:caobox"
  category: cms

requests:
  - method: GET
    # Base paths to identify Caobox CMS
    path:
      - "{{BaseURL}}/"
      - "{{BaseURL}}/admin/"
      - "{{BaseURL}}/index.php"
      - "{{BaseURL}}/readme.html"
      - "{{BaseURL}}/license.txt"
      - "{{BaseURL}}/robots.txt"
      - "{{BaseURL}}/admin/login.php"
      - "{{BaseURL}}/assets/"
      - "{{BaseURL}}/includes/"

    # Matchers to confirm Caobox CMS
    matchers:
      - type: word
        # Checking for unique keywords related to Caobox CMS
        words:
          - "Caobox CMS"
          - "powered by Caobox"
          - "Welcome to Caobox"
          - "Caobox version"
        condition: or

      - type: regex
        # Searching for possible patterns in HTML source
        regex:
          - "(?i)caobox"
          - "(?i)caobox\\s+(v[0-9.]+)" # Example: Caobox v1.2.3
          - "(?i)<title>Caobox CMS"

      - type: status
        # Checking if the server returns valid response codes
        status:
          - 200