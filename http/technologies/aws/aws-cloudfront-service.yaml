id: aws-cloudfront-service

info:
  name: AWS Cloudfront service detection
  author: jiheon-dev
  severity: info
  description: Detect websites using AWS cloudfront service
  metadata:
    max-request: 1
  tags: aws,tech,service

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers:
      - type: dsl
        condition: or
        dsl:
          - "contains(tolower(header), 'x-cache: hit from cloudfront')"
          - "contains(tolower(header), 'x-cache: refreshhit from cloudfront')"
          - "contains(tolower(header), 'x-cache: miss from cloudfront')"
          - "contains(tolower(header), 'x-cache: error from cloudfront')"
# digest: 4b0a00483046022100cf8f0eab8c20ea85cb01ddf6a8d81c1eb6c81b88f52d331c9474e408f163c1a4022100f2ad44429737cc440431c3358f77827f674fe0440cf817e64ab8477949143d3e:922c64590222798bb761d5b6d8e72950