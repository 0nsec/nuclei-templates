id: api-safebrowsing

info:
  name: Google Safe Browsing API Test
  author: daffainfo
  severity: info
  description: Google Link/Domain Flagging
  reference:
    - https://developers.google.com/books/docs/overview
    - https://github.com/daffainfo/all-about-apikey/tree/main/google-safe-browsing
  metadata:
    max-request: 1
  tags: token-spray,google,safebrowsing

self-contained: true

http:
  - raw:
      - |
        POST https://safebrowsing.googleapis.com/v4/threatListUpdates:fetch?key={{token}} HTTP/1.1
        Host: safebrowsing.googleapis.com
        Content-Type: application/json

    matchers:
      - type: word
        part: body
        words:
          - '"clientId"'
          - '"clientVersion"'
        condition: and
# digest: 490a0046304402201b765930b95ab6ba2f17d1a86dac628e0ec31299469baedfe08ab55c6a592895022046bfa705665e5862a6d3a752ae930ef2ab04b64630adebeb7a092afcae81d0ea:922c64590222798bb761d5b6d8e72950