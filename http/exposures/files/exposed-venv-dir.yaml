id: exposed-venv-dir

info:
  name: Exposed Python Virtual Environment Directory
  author: Al Baradi Joy
  severity: info
  description: >
    Detects publicly accessible /venv directories, which may expose the Python virtual environment.
    These folders typically contain package dependencies and config files like pyvenv.cfg.
  reference:
    - https://docs.python.org/3/library/venv.html
  tags: venv,file-disclosure,python-env,info,sensitive-file

requests:
  - method: GET
    path:
      - "{{BaseURL}}/venv/"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) NucleiScanner

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "Index of /venv"

      - type: word
        part: header
        words:
          - "text/html"
