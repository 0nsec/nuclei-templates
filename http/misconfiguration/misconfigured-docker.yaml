id: misconfigured-docker

info:
  name: Docker Container - Misconfiguration Exposure
  author: dhiyaneshDK
  severity: critical
  description: A Docker container misconfiguration was discovered. The Docker daemon can listen for Docker Engine API requests via three different types of Socket - unix, tcp, and fd. With tcp enabled, the default setup provides un-encrypted and un-authenticated direct access to the Docker daemon. It is conventional to use port 2375 for un-encrypted, and port 2376 for encrypted communication with the daemon.
  reference:
    - https://madhuakula.com/content/attacking-and-auditing-docker-containers-using-opensource/attacking-docker-containers/misconfiguration.html
  metadata:
    max-request: 1
  tags: misconfig,docker,unauth,devops

http:
  - method: GET
    path:
      - "{{BaseURL}}/images/json"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - '"ParentId":'
          - '"Containers":'
          - '"Labels":'
        condition: and

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100f75c149916efa1333e8ce2a7567efdca547aeda4e9c5234d7b5c39b5cdd5d451022100ce5460ee7e0db3174f445a24ea0de2496d4ef68a2b5879c035e7a365a969535d:922c64590222798bb761d5b6d8e72950