id: application-yaml

info:
  name: application.yaml detection
  author: Cristi vlad (@cristivlad25)
  severity: info
  description: Finds Application YAML files which often contain sensitive information.
  metadata:
    max-request: 4
  tags: misconfig

http:
  - method: GET
    path:
      - "{{BaseURL}}/app.yaml"
      - "{{BaseURL}}/app.yml"
      - "{{BaseURL}}/application.yaml"
      - "{{BaseURL}}/application.yml"

    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: word
        condition: or
        words:
          - "runtime:"
          - "spring:"
          - "datasource:"
          - "platform:"
          - "server:"
          - "job:"

      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - "!contains(tolower(body), '<html')"
          - "!contains(tolower(body), '<body')"
          - "!contains(tolower(body), '</h1>')"
          - "!contains(tolower(body), '</h2>')"
          - "!contains(tolower(body), '</h3>')"
          - "!contains(tolower(body), '<?xml')"
        condition: and
# digest: 4b0a00483046022100a20d9d6a2ab85b0c61a9eb9aefed3252cc3ac2ced628a14c5378af4bc485e58502210091f4c4ed164b303efdef32697ad9435df973f8f6664fade8a4b1dbac99982db2:922c64590222798bb761d5b6d8e72950