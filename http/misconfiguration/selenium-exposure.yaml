id: selenium-exposure

info:
  name: Selenium - Node Exposure
  author: w0Tx
  severity: high
  description: |
    Selenium was shown to have an exposed node. If a Selenium node is exposed without any form of authentication, remote command execution could be possible if chromium is configured. By default the port is 4444, still, most of the internet facing are done through reverse proxies.
  reference:
    - https://nutcrackerssecurity.github.io/selenium.html
    - https://labs.detectify.com/2017/10/06/guest-blog-dont-leave-your-grid-wide-open/
  classification:
    cpe: cpe:2.3:a:selenium:selenium:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: selenium
    product: selenium
    shodan-query: "/wd/hub"
  tags: misconfig,selenium,misconfiguration,rce,chromium

http:
  - method: GET
    path:
      - "{{BaseURL}}/wd/hub"

    host-redirects: true
    max-redirects: 2

    matchers-condition: and
    matchers:
      - type: word
        words:
          - 'WebDriverRequest'
          - '<title>WebDriver Hub</title>'
        condition: or

      - type: status
        status:
          - 200
# digest: 4a0a004730450221008643abe31eaa9ea873435c6ee798def43994e06ff3a21832e77c40047aadec70022067d45752b0737e30921e47319878db230d7d8c0c76a2a7bbbafa8251af5d5719:922c64590222798bb761d5b6d8e72950