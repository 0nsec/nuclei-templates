id: unauth-jupyter-lab

info:
  name: Jupyter Lab - Unauthenticated Access
  author: j4vaovo
  severity: critical
  description: |
    JupyterLab was able to be accessed without authentication.
  reference:
    - https://paper.seebug.org/2058/
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cwe-id: CWE-288
  metadata:
    max-request: 1
    shodan-query: http.favicon.hash:450899026
  tags: unauth,jupyter,jupyterlab,misconfig

http:
  - method: GET
    path:
      - '{{BaseURL}}/lab/api/settings/'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"id":'
          - '"settings"'
          - '"schema":'
        condition: and

      - type: word
        part: header
        words:
          - "application/json"

      - type: status
        status:
          - 200
# digest: 4a0a0047304502201b70ae7bfaa07ea38c15cdd305f5cfb027b0d95d3e1992e28b10d6b9ce0fb8e1022100aa659ae59be5e9858d31d4df0d5b02a8d939879e5f84027d2e7bd9f1b6c15319:922c64590222798bb761d5b6d8e72950