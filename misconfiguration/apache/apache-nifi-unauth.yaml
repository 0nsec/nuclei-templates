id: apache-nifi-unauth

info:
  name: Apache NiFi - Unauthenticated Access
  author: pwnhxl
  severity: high
  description: |
     Apache NiFi server was able to be accessed because no authentication was required.
  reference: |
    - https://github.com/jm0x0/apache_nifi_processor_rce
  metadata:
    verified: "true"
    fofa-query: title="nifi" && body="Did you mean"
  tags: apache,nifi,unauth

requests:
   - method: GET
     path:
       - "{{BaseURL}}/nifi-api/access/config"

     matchers-condition: and
     matchers:
       - type: word
         part: body
         words:
           - '{"config":{"supportsLogin":false}}'

       - type: word
         part: header
         words:
           - 'application/json'

       - type: status
         status:
           - 200
