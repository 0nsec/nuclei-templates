id: jupyter-lab-unauth

info:
  name: Jupyter Lab - Unauthenticated Access
  author: j4vaovo
  severity: critical
  description: JupyterLab was able to be accessed without authentication.
  reference:
    - https://paper.seebug.org/2058/
  classification:
    cvss-score: 10.0
    cvss-metrics: AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cwe-id: CWE-288
  tags: unauth,jupyter,jupyterlab

requests:
  - method: GET
    path:
      - "{{BaseURL}}/lab"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '<title>JupyterLab</title>'
          - '/static/lab'
          - '/lab/api/themes'
        condition: and

      - type: word
        part: header
        words:
          - 'text/html'

      - type: status
        status:
          - 200
