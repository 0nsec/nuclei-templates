id: root-remote-login

info:
  name: Linux Root Remote Login - Security Misconfiguration
  author: songyaeji
  severity: critical
  description: >
    Allowing remote access via Telnet or SSH for the root account poses a serious security risk.
    This template checks the configuration of /etc/securetty and sshd_config to determine whether root login is permitted.
  reference:
    - https://isms.kisa.or.kr/main/csap/notice/
    - Cloud Vulnerability Assessment Guide(2024) by KISA
  tags: linux,ssh,root,misconfiguration,local
  metadata:
    verified: true
    os: linux

self-contained: true
code:
  - engine:
      - bash
    source: |
      cat /etc/securetty 2>/dev/null | grep -E 'pts/[0-9]+' || echo "no-securetty"
    matchers:
      - type: word
        part: code_1_response
        words:
          - "pts/"
        condition: contains

  - engine:
      - bash
    source: |
      cat /etc/ssh/sshd_config 2>/dev/null | grep -E '^PermitRootLogin\s+yes' || echo "no-root-ssh"
    matchers:
      - type: word
        part: code_2_response
        words:
          - "PermitRootLogin yes"