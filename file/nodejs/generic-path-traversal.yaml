id: generic-path-traversal

info:
  name: Generic - Path Traversal
  author: me_dheeraj (https://twitter.com/Dheerajmadhukar)
  severity: info
  description: Untrusted user input in readFile()/readFileSync() can endup in Directory Traversal Attacks.
  tags: file,nodejs
file:
  - extensions:
      - all
    matchers:
      - type: regex
        regex:
          - "[^\\.]*\\.createReadStream\\([^\\)]*\\, <[\\s\\S]*?\\> [^\\)]*\\)"
          - "[^\\.]*\\.readFile\\([^\\)]*\\, <[\\s\\S]*?\\> [^\\)]*\\)"
          - "[^\\.]*\\.readFileSync\\([^\\)]*\\, <[\\s\\S]*?\\> [^\\)]*\\)"
          - "[^\\.]*\\.readFileAsync\\([^\\)]*\\, <[\\s\\S]*?\\> [^\\)]*\\)"
        condition: or
# digest: 4a0a004730450221009f067fe4b006cd32d200c2e3344a8dc0cc68cb7dd1afc2bfccbea53ed6d5e5bb02207daba89b5867b5b85c11d17d8de1f4e5a581c9754f85822bf1edf21832e3dd37:922c64590222798bb761d5b6d8e72950