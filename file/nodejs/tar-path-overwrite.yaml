id: tar-extraction

info:
  name: Path Injection Vulnerability in TAR Extraction
  author: me_dheeraj (https://twitter.com/Dheerajmadhukar)
  severity: info
  description: Insecure TAR archive extraction can result in arbitrary path over write and can result in code injection.
  tags: file,nodejs
file:
  - extensions:
      - all
    matchers:
      - type: regex
        regex:
          - "require\\('tar-stream'\\)"
          - "[\\w\\W]+?\\.createWriteStream\\([\\w\\W]*?\\, [\\w\\W]*?\\)"
          - "[\\w\\W]+?\\.writeFile\\([\\w\\W]*?\\, [\\w\\W]*?\\)"
          - "[\\w\\W]+?\\.writeFileSync\\([\\w\\W]*?\\, [\\w\\W]*?\\)"
        condition: or
# digest: 4a0a00473045022100fd1a3db6398098176517d26ae19d585a9144483ce8bfa24cab36f0f4c9e4a25c02201ef93ccb8e5880aebc496570104796889d734802840ca02dde58b391ced1cde7:922c64590222798bb761d5b6d8e72950