id: mongodb-network-open

info:
  name: MongoDB Network Interfaces Not Restricted
  author: pussycat0x
  severity: high
  description: |
    Ensures MongoDB is not exposed to public interfaces.
  remediation: |
    Set 'net.bindIp' to 127.0.0.1 or a specific IP in /etc/mongod.conf.
  reference:
    - https://www.mongodb.com/docs/manual/reference/configuration-options/
  tags: mongodb,file,audit

file:
  - extensions:
      - conf

    matchers:
      - type: regex
        regex:
          - "bindIp:\\s*(?!127\\.0\\.0\\.1)(\\d{1,3}\\.){3}\\d{1,3}"


      - type: word
        words:
          - "bindIp: 0.0.0.0"

