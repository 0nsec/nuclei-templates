id: nginx-hsts-missing

info:
  name: Missing HSTS - Nginx
  author: pussycat0x
  severity: high
  description: |
    Ensures that HSTS (Strict-Transport-Security) is enabled in Nginx.
  remediation: |
    Add 'add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload";' in /etc/nginx/nginx.conf under the server block.
  reference:
    - https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security
  tags: file,audit,nginx

file:
  - extensions:
      - conf

    matchers-condition: and
    matchers:
    - type: word
      words:
        - "http"
        - "events"
      condition: and

      - type: word
        words:
          - 'add_header Strict-Transport-Security '
        negative: true