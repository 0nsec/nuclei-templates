id: nginx-xss-protection

info:
  name: Nginx XSS Protection Header Check
  author: pussycat0x
  severity: high
  description: |
    Ensures that XSS protection is enabled in Nginx by checking for the 'X-XSS-Protection' header.
  remediation: |
    Add 'add_header X-XSS-Protection "1; mode=block";' in /etc/nginx/nginx.conf under the server block.
  reference:
    - https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection
  tags: nginx,xss,security,headers

file:
  - extensions:
      - conf

    matchers:
      - type: word
        words:
          - 'add_header X-XSS-Protection "1; mode=block";'

      - type: word
        words:
          - 'add_header X-XSS-Protection'
        negative: true

