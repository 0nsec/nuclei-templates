id: password-protected-consolemenu

info:
  name: PfSense Consolemenu Password Protection Not Implememnted - Detect
  author: pussycat0x
  severity: info
  description: |
    PfSense password protection via the Console Menu is recommended to be configured. An unattended computer with an open Console Menu session can allow an unauthorized user access to the firewall management.
  reference: |
    https://docs.netgate.com/pfsense/en/latest/config/advanced-admin.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    cvss-score: 0
    cwe-id: CWE-200
  metadata:
    verified: true
  tags: firewall,config,audit,pfsense,file

file:
  - extensions:
      - xml

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<disableconsolemenu>"
          - "<disableconsolemenu>1</disableconsolemenu>"
        condition: or
        negative: true

      - type: word
        words:
          - "<pfsense>"
          - "<webgui>"
          - "<system>"
        condition: and

# Enhanced by md on 2023/05/04
# digest: 490a0046304402206f06619b6b1a5c7d635d94f1286338d1716085d3d0ee7a06d7a28d7d8381587202204b91310197f93bf97265eb1bb028641b1104e636992b9ab48fd57fa0ad5c5313:922c64590222798bb761d5b6d8e72950