id: disable-server-header

info:
  name: Disable Server Header in Apache2
  author: pussycat0x
  severity: medium
  description: |
    Ensures that 'ServerTokens Prod' and 'ServerSignature Off' are correctly set in Apache to prevent server information leakage.
  remediation: |
    Set 'ServerTokens Prod' and 'ServerSignature Off' in Apache configuration and restart the service.
  reference:
    - https://httpd.apache.org/docs/2.4/mod/core.html#servertokens
    - https://httpd.apache.org/docs/2.4/mod/core.html#serversignature
  metadata:
    verified: true
  tags: audit,config,file,apache

file:
  - extensions:
      - conf

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "ServerTokens\\s+(Full|OS|Minimal|Major)"
        negative: true

      - type: word
        words:
          - "ServerTokens Prod"

      - type: word
        words:
          - "ServerSignature Off"

