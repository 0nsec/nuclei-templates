id: android-minsdk-21-check

info:
  name: AndroidManifest.xml minSdkVersion=21 Check (Local File Scan)
  author: Th3l0newolf
  severity: medium
  description: |
    This template identifies Android applications targeting Android 5.0 (API level 21) as their minimum SDK version.
    Applications with minSdkVersion=21 may be vulnerable to critical security issues in Android 5.0-5.0.2, including
    Stagefright vulnerabilities. It is recommended to target a higher minimum SDK version for better security.
  tags: android,file

file:
  - extensions:
      - xml
    matchers:
      - type: regex
        part: body
        regex:
          - "android:minSdkVersion\\s*=\\s*['\"]21['\"]"
