id: macgyver-malware

info:
  name: MacGyver.cap Malware - Detect
  author: daffainfo
  severity: info
  reference:
    - https://github.com/fboldewin/MacGyver-s-return---An-EMV-Chip-cloning-case/blob/master/MacGyver's%20return%20-%20An%20EMV%20Chip%20cloning%20case.pdf
    - https://github.com/Yara-Rules/rules/blob/master/malware/MALW_MacGyver.yar
  tags: malware,file
file:
  - extensions:
      - all
    matchers:
      - type: word
        part: raw
        words:
          - "src/MacGyver/javacard/Header.cap"
          - "src/MacGyver/javacard/Directory.cap"
          - "src/MacGyver/javacard/Applet.cap"
          - "src/MacGyver/javacard/Import.cap"
          - "src/MacGyver/javacard/ConstantPool.cap"
          - "src/MacGyver/javacard/Class.cap"
          - "src/MacGyver/javacard/Method.cap"
        condition: and
# digest: 4a0a00473045022100e65eb41fd37cdef00258bfba5ff1985078d1d84cf4240d7e357dab9da885e4a5022068fdae25f79c48c35cf9507dc341b3c1c43718a92d8b699c2b84eb72789caebd:922c64590222798bb761d5b6d8e72950