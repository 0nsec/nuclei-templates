id: miniasp3-malware

info:
  name: MiniASP3 Malware - Detect
  author: daffainfo
  severity: info
  reference: https://github.com/Yara-Rules/rules/blob/master/malware/MALW_MiniAsp3_mem.yar
  tags: malware,file
file:
  - extensions:
      - all

    matchers-condition: or
    matchers:
      - type: word
        part: raw
        words:
          - "MiniAsp3\\Release\\MiniAsp.pdb"
          - "http://%s/about.htm"
          - "http://%s/result_%s.htm"
          - "open internet failedâ€¦"
        condition: and

      - type: word
        part: raw
        words:
          - "MiniAsp3\\Release\\MiniAsp.pdb"
          - "http://%s/about.htm"
          - "http://%s/result_%s.htm"
          - "run error!"
        condition: and

      - type: word
        part: raw
        words:
          - "MiniAsp3\\Release\\MiniAsp.pdb"
          - "http://%s/about.htm"
          - "http://%s/result_%s.htm"
          - "run ok!"
        condition: and

      - type: word
        part: raw
        words:
          - "MiniAsp3\\Release\\MiniAsp.pdb"
          - "http://%s/about.htm"
          - "http://%s/result_%s.htm"
          - "time out,change to mode 0"
        condition: and

      - type: word
        part: raw
        words:
          - "MiniAsp3\\Release\\MiniAsp.pdb"
          - "http://%s/about.htm"
          - "http://%s/result_%s.htm"
          - "command is null!"
        condition: and
# digest: 4a0a0047304502203d3fa970b7ec4f4017c83c2b803cae687850ffad9bccc4e94ccafad66aad0c0c022100d17db8408ba32b1f30c812ff418f5fd0ac59683a61e6e9137bfbf6bfc6d70f7f:922c64590222798bb761d5b6d8e72950