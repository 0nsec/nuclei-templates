id: codoso-gh0st-malware
info:
  name: Codoso APT Gh0st Malware Hash - Detect
  author: pussycat0x
  severity: info
  reference:
    - https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks
    - https://github.com/Yara-Rules/rules/blob/master/malware/APT_Codoso.yar
  tags: malware,apt,codoso

file:
  - extensions:
      - all

    matchers:
      - type: dsl
        dsl:
          - "sha256(raw) == 'bf52ca4d4077ae7e840cf6cd11fdec0bb5be890ddd5687af5cfa581c8c015fcd'"
          - "sha256(raw) == '5402c785037614d09ad41e41e11093635455b53afd55aa054a09a84274725841'"
          - "sha256(raw) == '7dc7cec2c3f7e56499175691f64060ebd955813002d4db780e68a8f6e7d0a8f8'"
          - "sha256(raw) == 'd7004910a87c90ade7e5ff6169f2b866ece667d2feebed6f0ec856fb838d2297'"
        condition: or
# digest: 490a0046304402206041fd734eac4bc034df5996dae1019c85b71a84a6f09c74c66bf3c8551aab4e022031297079a1b8b993d4c27c29bdefffa423b3797574dd5853c1ccf2cd7ba3a1f8:922c64590222798bb761d5b6d8e72950