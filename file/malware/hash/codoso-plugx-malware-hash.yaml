id: codoso-plugx-malware-hash
info:
  name: Codoso APT PlugX Malware Hash - Detect
  author: pussycat0x
  severity: info
  description: |
    Detects Codoso APT PlugX Malware.
  reference:
    - https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks
    - https://github.com/Yara-Rules/rules/blob/master/malware/APT_Codoso.yar
  tags: malware,apt,codoso

file:
  - extensions:
      - all

    matchers:
      - type: dsl
        dsl:
          - "sha256(raw) == '74e1e83ac69e45a3bee78ac2fac00f9e897f281ea75ed179737e9b6fe39971e3'"
          - "sha256(raw) == 'b9510e4484fa7e3034228337768176fce822162ad819539c6ca3631deac043eb'"
          - "sha256(raw) == '74e1e83ac69e45a3bee78ac2fac00f9e897f281ea75ed179737e9b6fe39971e3'"
          - "sha256(raw) == '74e1e83ac69e45a3bee78ac2fac00f9e897f281ea75ed179737e9b6fe39971e3'"
        condition: or
# digest: 4b0a00483046022100c0eeeb0254bd6edb453c5ea5daa762bf4fc8bfca5504835bf992222324d88279022100afffd8392211d5241ae9bf862fd5570e36af73b8c180c0a39670b98a80aa2c6e:922c64590222798bb761d5b6d8e72950