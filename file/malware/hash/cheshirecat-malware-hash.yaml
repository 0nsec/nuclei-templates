id: cheshirecat-malware-hash
info:
  name: CheshireCat Malware Hash - Detect
  author: pussycat0x
  severity: info
  reference:
    - https://malware-research.org/prepare-father-of-stuxnet-news-are-coming/
    - https://github.com/Yara-Rules/rules/blob/master/malware/APT_CheshireCat.yar
  tags: malware,apt

file:
  - extensions:
      - all

    matchers:
      - type: dsl
        dsl:
          - "sha256(raw) == 'ec41b029c3ff4147b6a5252cb8b659f851f4538d4af0a574f7e16bc1cd14a300'"
          - "sha256(raw) == '32159d2a16397823bc882ddd3cd77ecdbabe0fde934e62f297b8ff4d7b89832a'"
          - "sha256(raw) == '63735d555f219765d486b3d253e39bd316bbcb1c0ec595ea45ddf6e419bef3cb'"
          - "sha256(raw) == 'c074aeef97ce81e8c68b7376b124546cabf40e2cd3aff1719d9daa6c3f780532'"
        condition: or
# digest: 4b0a00483046022100cc95726a02e6716697818e24579d1b41ebc04fe6538ee51ded0eb66b55043f39022100838488f50cdde5bc20870123167d0995d295f8d2219e1844d77fec294132c225:922c64590222798bb761d5b6d8e72950