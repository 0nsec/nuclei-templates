id: petya-malware-variant-1

info:
  name: Petya Malware (Variant 1) - Detect
  author: daffainfo
  severity: info
  reference: https://github.com/airbnb/binaryalert/blob/master/rules/public/ransomware/windows/ransomware_windows_petya_variant_1.yara
  tags: malware,file,petya
file:
  - extensions:
      - all
    matchers:
      - type: word
        part: raw
        words:
          - "Ooops, your important files are encrypted."
          - "Send your Bitcoin wallet ID and personal installation key to e-mail"
          - "wowsmith123456@posteo.net. Your personal installation key:"
          - "Send $300 worth of Bitcoin to following address:"
          - "have been encrypted.  Perhaps you are busy looking for a way to recover your"
          - "need to do is submit the payment and purchase the decryption key."
        condition: or
# digest: 4a0a00473045022100ef642a585672b00167e919c473ede00027c35cc7553db600c799dcc1e80af0f80220591fed766c9d9f17b842d0688009dc81848e127d5e6b264753877d7a11409d4b:922c64590222798bb761d5b6d8e72950