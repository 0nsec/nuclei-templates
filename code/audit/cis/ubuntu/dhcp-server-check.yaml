id: dhcp-server-check

info:
  name: Ensure DHCP Server Service is Not Installed
  author: Th3l0newolf
  severity: medium
  description: |
    This template checks whether the ISC DHCP server package (`isc-dhcp-server`) is installed.
    Running a DHCP server on systems not designated for that role can pose security risks and introduce unwanted network behavior.
  remediation: |
    Run: sudo apt-get remove isc-dhcp-server -y
    This removes the DHCP server if it is not needed.
  reference:
    - https://www.cisecurity.org/benchmark/ubuntu_linux
  metadata:
    verified: true
  tags: cis,linux,dhcp,package,benchmark,audit,ubuntu

self-contained: true

code:
  - engine:
      - bash
    args:
      - "-c"
      - |
        if dpkg-query -s isc-dhcp-server &>/dev/null; then
          echo "[dhcp-server-check:Policy-Fail] [isc-dhcp-server is installed] [CIS_FAIL] [medium]"
        else
          echo "[dhcp-server-check:Policy-Pass] [isc-dhcp-server is not installed] [CIS_PASS] [medium]"
        fi

    matchers:
      - type: word
        name: policy-pass
        words:
          - "Policy-Pass"

      - type: word
        name: policy-fail
        words:
          - "Policy-Fail"
# digest: 4b0a00483046022100911c6140fdc6cedd6277839b26d0bbba99fcd89473c5069f12d77cd33c287db8022100d9593ed74c89c9de5c831bb7b31ecb6df649e6e3eca420216c41de0768ba3192:8d4678b72cd931431edd8f38bb1cef76