id: autofs-service-check

info:
  name: Ensure autofs Service is Not Installed
  author: Th3l0newolf
  severity: medium
  description: |
    The autofs package determined whether automatic mounting of file systems was enabled. When installed, the autofs service allowed automatic mounting, which could have introduced security risks if not explicitly required.
  remediation: |
    Run: sudo apt-get remove autofs -y
    This removes the autofs package if it is not required.
  reference:
    - https://www.cisecurity.org/benchmark/ubuntu_linux
  metadata:
    verified: true
  tags: cis,linux,autofs,benchmark,audit,ubuntu

self-contained: true

code:
  - engine:
      - bash
    args:
      - "-c"
      - |
        if dpkg-query -s autofs &>/dev/null; then
          echo "[autofs-service-check:Policy-Fail] [autofs is installed] [CIS_FAIL] [medium]"
        else
          echo "[autofs-service-check:Policy-Pass] [autofs is not installed] [CIS_PASS] [medium]"
        fi

    matchers:
      - type: word
        name: policy-pass
        words:
          - "Policy-Pass"

      - type: word
        name: policy-fail
        words:
          - "Policy-Fail"
# digest: 4a0a004730450220106b65a516c5f6ce32dade5cfaf2b59a37a9d64926960cf1799810e6b8231e590221009d26579fc6286127152c04ed8f219e52a8f22327395be2288e233793b4745ce5:8d4678b72cd931431edd8f38bb1cef76