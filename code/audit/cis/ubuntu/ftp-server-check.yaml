id: ftp-server-check

info:
  name: Ensure FTP Server Service is Not Installed
  author: Th3l0newolf
  severity: medium
  description: |
    The vsftpd package indicated whether an FTP server was installed on the system. FTP was an unencrypted and insecure protocol, and the service should not have been installed unless explicitly required.
  remediation: |
    Run: sudo apt-get remove vsftpd -y
    This removes the FTP server to reduce potential security risks.
  reference:
    - https://www.cisecurity.org/benchmark/ubuntu_linux
  metadata:
    verified: true
  tags: cis,linux,vsftpd,ftp,package,benchmark,audit,ubuntu

self-contained: true

code:
  - engine:
      - bash
    args:
      - "-c"
      - |
        if dpkg-query -s vsftpd &>/dev/null; then
          echo "[ftp-server-check:Policy-Fail] [vsftpd is installed] [CIS_FAIL] [medium]"
        else
          echo "[ftp-server-check:Policy-Pass] [vsftpd is not installed] [CIS_PASS] [medium]"
        fi

    matchers:
      - type: word
        name: policy-pass
        words:
          - "Policy-Pass"

      - type: word
        name: policy-fail
        words:
          - "Policy-Fail"
# digest: 490a00463044022067483b923ad35b7dbe190990a8153bcb3fc6eabf15ed6668edaa599177d755ff02206d9674896d4e5dec2acc8372c3ed4a07fc81c2dcc9353370fc3e5d6981c604cf:8d4678b72cd931431edd8f38bb1cef76