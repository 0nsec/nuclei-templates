id: dns-server-check

info:
  name: Ensure DNS Server Service is Not Installed
  author: Th3l0newolf
  severity: medium
  description: |
    This template checks whether the DNS server package (`bind9`) is installed.
    Running a DNS server on systems not intended for that purpose can expose the system to unnecessary risks.
  remediation: |
    Run: sudo apt-get remove bind9 -y
    This removes the BIND DNS server package if it is not required.
  reference:
    - https://www.cisecurity.org/benchmark/ubuntu_linux
  tags: cis,linux,dns,bind9,package,security,audit,ubuntu
  metadata:
    verified: true

self-contained: true

code:
  - engine:
      - bash
    args:
      - "-c"
      - |
        if dpkg-query -s bind9 &>/dev/null; then
          echo "[dns-server-check:Policy-Fail] [bind9 is installed] [CIS_FAIL] [medium]"
        else
          echo "[dns-server-check:Policy-Pass] [bind9 is not installed] [CIS_PASS] [medium]"
        fi

    matchers:
      - type: word
        name: policy-pass
        words:
          - "Policy-Pass"

      - type: word
        name: policy-fail
        words:
          - "Policy-Fail"
# digest: 490a00463044022044f27be9a0550a923af09d7fc810c5af04042391bde13b95abe36e4b3d86ef2f02200e17c8a84148ff0ba4408d3688003cb243de64dd9d2b9a6778fccba0786cac11:8d4678b72cd931431edd8f38bb1cef76