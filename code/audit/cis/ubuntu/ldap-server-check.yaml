id: ldap-server-check

info:
  name: Ensure LDAP Server Service is Not Installed
  author: Th3l0newolf
  severity: medium
  description: |
    This template checks if the LDAP server package (`slapd`) is installed.
    LDAP servers should not be installed unless explicitly required, as they may expose sensitive identity services.
  remediation: |
    Run: sudo apt-get remove slapd -y
    This removes the LDAP server package to reduce the systemâ€™s attack surface.
  reference:
    - https://www.cisecurity.org/benchmark/ubuntu_linux
  metadata:
    verified: true
  tags: cis,linux,ldap,slapd,package,benchmark,audit,ubuntu

self-contained: true

code:
  - engine:
      - bash
    args:
      - "-c"
      - |
        if dpkg-query -s slapd &>/dev/null; then
          echo "[ldap-server-check:Policy-Fail] [slapd is installed] [CIS_FAIL] [medium]"
        else
          echo "[ldap-server-check:Policy-Pass] [slapd is not installed] [CIS_PASS] [medium]"
        fi

    matchers:
      - type: word
        name: policy-pass
        words:
          - "Policy-Pass"

      - type: word
        name: policy-fail
        words:
          - "Policy-Fail"
# digest: 490a00463044022034ab908525a832fe42d03d8e23fb0e647174001ab1100f5234ac5f017e04f8bc02203c5cf37102388616f59aca05273474de09d1bf66b6f6da0aafb280e3dba48558:8d4678b72cd931431edd8f38bb1cef76