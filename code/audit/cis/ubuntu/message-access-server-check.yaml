id: message-access-server-check

info:
  name: Ensure Message Access Server Service is Not Installed
  author: Th3l0newolf
  severity: medium
  description: |
    The dovecot-imapd package indicated whether an IMAP message access server was installed on the system. IMAP services like Dovecot should not have been installed unless explicitly required, to reduce exposure to remote access vulnerabilities.
  remediation: |
    Run: sudo apt-get remove dovecot-imapd -y
    This will remove the message access server and reduce unnecessary service exposure.
  reference:
    - https://www.cisecurity.org/benchmark/ubuntu_linux
  metadata:
    verified: true
  tags: cis,linux,dovecot,imap,email,package,benchmark,audit,ubuntu

self-contained: true

code:
  - engine:
      - bash
    args:
      - "-c"
      - |
        if dpkg-query -s dovecot-imapd &>/dev/null; then
          echo "[message-access-server-check:Policy-Fail] [dovecot-imapd is installed] [CIS_FAIL] [medium]"
        else
          echo "[message-access-server-check:Policy-Pass] [dovecot-imapd is not installed] [CIS_PASS] [medium]"
        fi

    matchers:
      - type: word
        name: policy-pass
        words:
          - "Policy-Pass"

      - type: word
        name: policy-fail
        words:
          - "Policy-Fail"
# digest: 490a0046304402203b71a2cf010240bb9388337629ef4341ba302b98999a54cd5964278845c12754022001e95aa460440437e308a03a76cda72f4f94c6b06a66ae66ea44367e00a0d793:8d4678b72cd931431edd8f38bb1cef76