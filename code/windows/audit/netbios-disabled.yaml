id: netbios-disabled

info:
  name: NetBIOS Disabled
  author: princechaddha
  severity: medium
  description: Determine if NetBIOS over TCP/IP is disabled on all network adapters.
  impact: |
    Enabling NetBIOS can expose systems to network-related attacks such as traffic interception and spoofing.
  remediation: |
    Disable NetBIOS on all network adapters to mitigate potential security risks.
  tags: windows,netbios,network,security,code,windows-audit

self-contained: true

code:
  - pre-condition: |
      IsWindows();
    engine:
      - powershell
      - powershell.exe
    args:
      - -ExecutionPolicy
      - Bypass
    pattern: "*.ps1"
    source: |
      $netbiosStatus = Get-WmiObject Win32_NetworkAdapterConfiguration | Where-Object { $_."TCP/IPNetBIOSOptions" -ne 2 }
      if ($netbiosStatus) {"NetBIOS is misconfigured or enabled"} else {"NetBIOS is correctly disabled"}

    matchers:
      - type: word
        words:
          - "NetBIOS is misconfigured or enabled"
# digest: 4a0a00473045022100e7b51ef543fe9a47ba67520d8d04c436d45f78a9ddd53579ee8bd260d615a137022020a50d174c0a9155f0f08cfcff80bee0060a50f56b41efc2a4331a1a2c7122d5:922c64590222798bb761d5b6d8e72950