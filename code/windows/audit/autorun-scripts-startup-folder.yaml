id: autorun-scripts-startup-folder

info:
  name: Autorun Scripts in Startup Folder
  author: princechaddha
  severity: medium
  description: Detect unauthorized scripts or executables in startup folders.
  impact: |
    Unauthorized scripts or executables can lead to the execution of malicious software during system startup.
  remediation: |
    Remove any unauthorized scripts or executables from the startup folder and implement security policies to restrict future unauthorized additions.
  tags: windows,startup,autorun,code,windows-audit

self-contained: true

code:
  - pre-condition: |
      IsWindows();
    engine:
      - powershell
      - powershell.exe
    args:
      - -ExecutionPolicy
      - Bypass
    pattern: "*.ps1"
    source: |
      Get-ChildItem -Path "$env:ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp"

    matchers:
      - type: word
        words:
          - ".exe"
          - ".ps1"
# digest: 4a0a0047304502207584cf5f986c79598a6bd64f98a8e12062a40d340111ff59e81922d602db39b5022100a0cd06d7943183ac399eed588f3eb6bbc82905fcc32511daa4cb1f8c0698cfa5:922c64590222798bb761d5b6d8e72950