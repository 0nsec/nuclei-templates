id: autorun-scripts-startup-folder

info:
  name: Autorun Scripts in Startup Folder
  author: princechaddha
  severity: medium
  description: Detect unauthorized scripts or executables in startup folders.
  impact: |
    Unauthorized scripts or executables can lead to the execution of malicious software during system startup.
  remediation: |
    Remove any unauthorized scripts or executables from the startup folder and implement security policies to restrict future unauthorized additions.
  tags: windows,startup,autorun,code,windows-audit

self-contained: true

code:
  - pre-condition: |
      IsWindows();
    engine:
      - powershell
      - powershell.exe
    args:
      - -ExecutionPolicy
      - Bypass
    pattern: "*.ps1"
    source: |
      Get-ChildItem -Path "$env:ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp"

    matchers:
      - type: word
        words:
          - ".exe"
          - ".ps1"
# digest: 4a0a00473045022100d06888e10f1d3399fc115299af1835c05232d00a1bc80fc14e12cbcd39fec8dc02203c1ef28e982c3c857c2342908d09ffb54fcc29014a96f8bc0b0470e29835af03:922c64590222798bb761d5b6d8e72950