id: anonymous-sid-enumeration-enabled

info:
  name: Anonymous SID Enumeration Enabled
  author: princechaddha
  severity: medium
  description: Checks if anonymous users can enumerate Security Identifiers (SIDs).
  impact: |
    Allowing anonymous SID enumeration can expose user account details and increase the risk of unauthorized access.
  remediation: |
    Restrict anonymous access to SID enumeration to enhance security.
  tags: windows,code,windows-audit

self-contained: true

code:
  - pre-condition: |
      IsWindows();
    engine:
      - powershell
      - powershell.exe
    args:
      - -ExecutionPolicy
      - Bypass
    pattern: "*.ps1"
    source: |
      Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Lsa' -Name 'EveryoneIncludesAnonymous'

    matchers:
      - type: word
        words:
          - "everyoneincludesanonymous : 1"
# digest: 4a0a0047304502203d810fe627e3b3d3525a4a3c03cfdad30a0032fe0b05c8fde4c216bbb9a1c7d4022100d762d79c12b0a80c8299eca5acadc0271a64983dc9829f10cc3e33eb9dd8c3da:922c64590222798bb761d5b6d8e72950