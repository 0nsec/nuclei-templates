id: minimum-password-age-zero

info:
  name: Minimum Password Age Set to Zero
  author: princechaddha
  severity: medium
  description: Checks if the minimum password age is set to zero, allowing immediate password changes and potential reuse.
  impact: |
    Allowing a password age of zero may lead to the rapid reuse of weak passwords, reducing account security.
  remediation: |
    Set a reasonable minimum password age to prevent users from reusing old passwords frequently.
  tags: windows, password, policy, code, windows-audit

self-contained: true

code:
  - pre-condition: |
      IsWindows();
    engine:
      - cmd
    args:
      - /c
    pattern: "*.cmd"
    source: |
      net accounts

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "Minimum password age (days):                          0"
        negative: true

      - type: word
        words:
          - "Minimum password age"

# digest: 4b0a00483046022100c2ea28b5a4af1e1d0a301c1c7db9d35b8957a42cc8122af89e7f04e05b5f21a4022100ac47a07d7913ee4903e0b39195a0fc929d273495e299f24bbe4fd44c043f8956:922c64590222798bb761d5b6d8e72950