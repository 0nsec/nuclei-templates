id: rpc-enabled

info:
  name: Unnecessary RPC Service (rstatd) Enabled
  author: songyaeji
  severity: high
  description: |
    Unnecessary RPC services like rstatd were enabled, allowing attackers to exploit buffer overflow, DoS, or remote execution vulnerabilities to gain root privileges and compromise the system.These services were expected to be disabled unless explicitly required.
  reference:
    - https://isms.kisa.or.kr
  tags: linux,local,audit,compliance,kisas

self-contained: true

code:
  - engine:
      - bash
    source: |
      if [ -f /etc/xinetd.d/rstatd ]; then
        if grep -qE 'disable\s*=\s*no' /etc/xinetd.d/rstatd; then
          echo "[VULNERABLE] rstatd RPC service is enabled in xinetd"
        else
          echo "[SAFE] rstatd RPC service is disabled in xinetd"
        fi
      elif systemctl is-active --quiet rstatd 2>/dev/null; then
        echo "[VULNERABLE] rstatd service is active under systemd"
      else
        echo "[SAFE] rstatd service not found"
      fi

    matchers:
      - type: word
        part: response
        words:
          - "[VULNERABLE]"