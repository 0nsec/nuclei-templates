id: linux-legacy-services-enabled

info:
  name: DoS Vulnerable Service Enabled
  author: songyaeji
  severity: high
  description: |
    Services such as echo, discard, daytime, and chargen were enabled on the system, allowing attackers to exploit them to extract system information or launch denial-of-service (DoS) attacks.These legacy services were required to be disabled unless explicitly needed.
  reference:
    - https://isms.kisa.or.kr
    - Cloud Vulnerability Assessment Guide(2024) by KISA
  tags: linux,misconfiguration

self-contained: true

code:
  - engine:
      - bash
    source: |
      if [ -f "/etc/xinetd.d/echo" ] && grep -iq 'disable[[:space:]]*=[[:space:]]*no' "/etc/xinetd.d/echo"; then
        echo "[VULNERABLE] echo service is enabled in /etc/xinetd.d/echo"
      else
        echo "[SAFE] echo service is disabled or not present"
      fi

  - engine:
      - bash
    source: |
      if [ -f "/etc/xinetd.d/discard" ] && grep -iq 'disable[[:space:]]*=[[:space:]]*no' "/etc/xinetd.d/discard"; then
        echo "[VULNERABLE] discard service is enabled in /etc/xinetd.d/discard"
      else
        echo "[SAFE] discard service is disabled or not present"
      fi

  - engine:
      - bash
    source: |
      if [ -f "/etc/xinetd.d/daytime" ] && grep -iq 'disable[[:space:]]*=[[:space:]]*no' "/etc/xinetd.d/daytime"; then
        echo "[VULNERABLE] daytime service is enabled in /etc/xinetd.d/daytime"
      else
        echo "[SAFE] daytime service is disabled or not present"
      fi

  - engine:
      - bash
    source: |
      if [ -f "/etc/xinetd.d/chargen" ] && grep -iq 'disable[[:space:]]*=[[:space:]]*no' "/etc/xinetd.d/chargen"; then
        echo "[VULNERABLE] chargen service is enabled in /etc/xinetd.d/chargen"
      else
        echo "[SAFE] chargen service is disabled or not present"
      fi

    matchers:
      - type: word
        name: echo
        part: code_1_response
        words:
          - "[VULNERABLE]"

      - type: word
        name: daytime
        part: code_2_response
        words:
          - "[VULNERABLE]"

      - type: word
        name: chargen
        part: code_3_response
        words:
          - "[VULNERABLE]"

      - type: word
        name: discard
        part: code_4_response
        words:
          - "[VULNERABLE]"